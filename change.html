<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üå±</text></svg>">
    <title>BABY PHUM MACHINE</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
    background: url('https://i.ibb.co/Hf7VjRbp/desktop-wallpaper-milky-green-blurred-backgrounds-blur.jpg') center/cover fixed;
    min-height: 100vh;
    padding: 16px;
}
/* ===================================
   üíé GLASSMORPHISM - ‡πÇ‡∏´‡∏°‡∏î‡∏™‡∏ß‡πà‡∏≤‡∏á
   =================================== */

/* ===================================
   üíé LIQUID GLASS / GLASSMORPHISM
   =================================== */

/* ‚≠ê Header - Liquid Glass */
.header {
    background: linear-gradient(135deg, 
        rgba(46, 125, 50, 0.25) 0%, 
        rgba(76, 175, 80, 0.25) 100%), 
        url('https://i.ibb.co/MkmmJcxW/your-image.jpg') 0% center/cover no-repeat;
    backdrop-filter: blur(40px) saturate(180%);
    -webkit-backdrop-filter: blur(40px) saturate(180%);
    border: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow: 
        0 8px 32px rgba(31, 38, 135, 0.15),
        inset 0 1px 1px rgba(255, 255, 255, 0.4);
}

/* ‚≠ê Cards & Timer Card - Liquid Glass */
.card,
.timer-card {
    background: rgba(255, 255, 255, 0.25);
    backdrop-filter: blur(30px) saturate(150%);
    -webkit-backdrop-filter: blur(30px) saturate(150%);
    border: 1px solid rgba(255, 255, 255, 0.4);
    box-shadow: 
        0 8px 32px rgba(0, 0, 0, 0.08),
        inset 0 1px 1px rgba(255, 255, 255, 0.5);
}

/* ‚≠ê Hamburger Button - Liquid Glass */
.hamburger-btn {
    background: rgba(255, 255, 255, 0.35);
    backdrop-filter: blur(25px) saturate(180%);
    -webkit-backdrop-filter: blur(25px) saturate(180%);
    border: 1px solid rgba(255, 255, 255, 0.5);
    box-shadow: 
        0 4px 20px rgba(0, 0, 0, 0.1),
        inset 0 1px 1px rgba(255, 255, 255, 0.6);
}

/* ‚≠ê Sidebar - Liquid Glass */
.sidebar {
    background: rgba(255, 255, 255, 0.3);
    backdrop-filter: blur(40px) saturate(180%);
    -webkit-backdrop-filter: blur(40px) saturate(180%);
    border-right: 1px solid rgba(255, 255, 255, 0.5);
    box-shadow: 4px 0 30px rgba(0, 0, 0, 0.1);
}

/* ‚≠ê Sidebar Menu Items - Liquid Glass */
.sidebar-menu-item {
    background: rgba(255, 255, 255, 0.3);
    backdrop-filter: blur(20px) saturate(150%);
    -webkit-backdrop-filter: blur(20px) saturate(150%);
    border: 1px solid rgba(255, 255, 255, 0.4);
    box-shadow: 
        0 2px 10px rgba(0, 0, 0, 0.05),
        inset 0 1px 1px rgba(255, 255, 255, 0.5);
}

.sidebar-menu-item:hover {
    background: linear-gradient(135deg, 
        rgba(200, 230, 201, 0.4) 0%, 
        rgba(165, 214, 167, 0.4) 100%);
    backdrop-filter: blur(25px) saturate(180%);
    -webkit-backdrop-filter: blur(25px) saturate(180%);
    box-shadow: 
        0 4px 15px rgba(76, 175, 80, 0.2),
        inset 0 1px 1px rgba(255, 255, 255, 0.6);
}

/* ‚≠ê Switch Items - Liquid Glass */
.switch-item {
    background: rgba(255, 248, 225, 0.35);
    backdrop-filter: blur(20px) saturate(150%);
    -webkit-backdrop-filter: blur(20px) saturate(150%);
    border: 2px solid rgba(255, 224, 130, 0.5);
    box-shadow: 
        0 4px 15px rgba(0, 0, 0, 0.08),
        inset 0 1px 1px rgba(255, 255, 255, 0.5);
}

.switch-item.light {
    background: rgba(255, 249, 196, 0.35);
    backdrop-filter: blur(20px) saturate(150%);
    -webkit-backdrop-filter: blur(20px) saturate(150%);
    border-color: rgba(253, 216, 53, 0.5);
}

.switch-item.oxygen {
    background: rgba(232, 245, 233, 0.35);
    backdrop-filter: blur(20px) saturate(150%);
    -webkit-backdrop-filter: blur(20px) saturate(150%);
    border-color: rgba(129, 199, 132, 0.5);
}

.switch-item.pump {
    background: rgba(225, 245, 254, 0.35);
    backdrop-filter: blur(20px) saturate(150%);
    -webkit-backdrop-filter: blur(20px) saturate(150%);
    border-color: rgba(129, 212, 250, 0.5);
}

/* ‚≠ê LED Items - Liquid Glass */
.led-item {
    background: rgba(250, 250, 250, 0.3);
    backdrop-filter: blur(20px) saturate(150%);
    -webkit-backdrop-filter: blur(20px) saturate(150%);
    border: 2px solid rgba(232, 232, 232, 0.5);
    box-shadow: 
        0 4px 15px rgba(0, 0, 0, 0.06),
        inset 0 1px 1px rgba(255, 255, 255, 0.5);
}

/* ‚≠ê Timer Items - Liquid Glass */
.timer-item {
    background: rgba(232, 245, 233, 0.35);
    backdrop-filter: blur(25px) saturate(160%);
    -webkit-backdrop-filter: blur(25px) saturate(160%);
    border: 2px solid rgba(129, 199, 132, 0.5);
    box-shadow: 
        0 4px 15px rgba(76, 175, 80, 0.1),
        inset 0 1px 1px rgba(255, 255, 255, 0.5);
}

.timer-item.inactive {
    background: rgba(245, 245, 245, 0.35);
    backdrop-filter: blur(25px) saturate(140%);
    -webkit-backdrop-filter: blur(25px) saturate(140%);
    border-color: rgba(189, 189, 189, 0.5);
}

/* ‚≠ê Settings Items - Liquid Glass */
.settings-item {
    background: rgba(248, 249, 250, 0.3);
    backdrop-filter: blur(20px) saturate(150%);
    -webkit-backdrop-filter: blur(20px) saturate(150%);
    border: 2px solid rgba(232, 232, 232, 0.5);
    box-shadow: 
        0 4px 15px rgba(0, 0, 0, 0.06),
        inset 0 1px 1px rgba(255, 255, 255, 0.5);
}

.settings-option {
    background: rgba(255, 255, 255, 0.35);
    backdrop-filter: blur(15px) saturate(150%);
    -webkit-backdrop-filter: blur(15px) saturate(150%);
    border: 1px solid rgba(255, 255, 255, 0.4);
    box-shadow: 
        0 2px 10px rgba(0, 0, 0, 0.04),
        inset 0 1px 1px rgba(255, 255, 255, 0.5);
}

/* ‚≠ê History & Fertilizer Items - Liquid Glass */
.history-item {
    background: rgba(232, 245, 233, 0.4);
    backdrop-filter: blur(15px) saturate(150%);
    -webkit-backdrop-filter: blur(15px) saturate(150%);
    box-shadow: 
        0 4px 12px rgba(76, 175, 80, 0.1),
        inset 0 1px 1px rgba(255, 255, 255, 0.5);
}

.fertilizer-item {
    background: rgba(255, 243, 224, 0.4);
    backdrop-filter: blur(15px) saturate(150%);
    -webkit-backdrop-filter: blur(15px) saturate(150%);
    box-shadow: 
        0 4px 12px rgba(255, 152, 0, 0.1),
        inset 0 1px 1px rgba(255, 255, 255, 0.5);
}

/* ‚≠ê Confirm Dialog - Liquid Glass */
.confirm-dialog {
    background: rgba(255, 255, 255, 0.4);
    backdrop-filter: blur(40px) saturate(180%);
    -webkit-backdrop-filter: blur(40px) saturate(180%);
    border: 1px solid rgba(255, 255, 255, 0.5);
    box-shadow: 
        0 20px 60px rgba(0, 0, 0, 0.15),
        inset 0 1px 1px rgba(255, 255, 255, 0.6);
}

/* ‚≠ê Info Box - Liquid Glass */
.info-box {
    background: rgba(255, 243, 224, 0.4);
    backdrop-filter: blur(20px) saturate(150%);
    -webkit-backdrop-filter: blur(20px) saturate(150%);
    border: 2px solid rgba(255, 183, 77, 0.5);
    box-shadow: 
        0 4px 15px rgba(255, 152, 0, 0.1),
        inset 0 1px 1px rgba(255, 255, 255, 0.5);
}

/* ‚≠ê Alert Banner - Liquid Glass */
.alert-banner {
    background: rgba(255, 243, 224, 0.4);
    backdrop-filter: blur(20px) saturate(150%);
    -webkit-backdrop-filter: blur(20px) saturate(150%);
    border: 2px solid rgba(255, 152, 0, 0.5);
    box-shadow: 
        0 4px 15px rgba(255, 152, 0, 0.15),
        inset 0 1px 1px rgba(255, 255, 255, 0.5);
}

.alert-banner.harvest {
    background: rgba(232, 245, 233, 0.4);
    border-color: rgba(76, 175, 80, 0.5);
    box-shadow: 
        0 4px 15px rgba(76, 175, 80, 0.15),
        inset 0 1px 1px rgba(255, 255, 255, 0.5);
}

/* ‡∏•‡∏ö overlay ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏´‡∏°‡∏î‡∏°‡∏∑‡∏î */
body.dark-mode::before {
    display: none;
}
/* ===================================
   BASE STYLES (properties ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö glassmorphism)
   =================================== */

.hamburger-btn {
    position: fixed;
    top: 20px;
    left: 20px;
    width: 50px;
    height: 50px;
    /* background ‡∏ñ‡∏π‡∏Å‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏ô glassmorphism section ‡πÅ‡∏•‡πâ‡∏ß */
    border-radius: 12px;
    cursor: pointer;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
    z-index: 1001;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 5px;
    transition: all 0.3s;
}

.sidebar {
    position: fixed;
    top: 0;
    left: -400px;
    width: 400px;
    height: 100vh;
    /* background ‡∏ñ‡∏π‡∏Å‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏ô glassmorphism section ‡πÅ‡∏•‡πâ‡∏ß */
    box-shadow: 4px 0 20px rgba(0, 0, 0, 0.2);
    z-index: 1000;
    transition: left 0.3s;
    overflow-y: auto;
}

.card,
.timer-card {
    /* background ‡∏ñ‡∏π‡∏Å‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏ô glassmorphism section ‡πÅ‡∏•‡πâ‡∏ß */
    border-radius: 20px;
    padding: 20px;
    margin-bottom: 16px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
}

        .hamburger-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
        }

.hamburger-line {
    width: 24px;
    height: 3px;
    background: #2E7D32;
    border-radius: 2px;
    transition: all 0.3s;
}

        .hamburger-btn.active .hamburger-line:nth-child(1) {
            transform: translateY(8px) rotate(45deg);
        }

        .hamburger-btn.active .hamburger-line:nth-child(2) {
            opacity: 0;
        }

        .hamburger-btn.active .hamburger-line:nth-child(3) {
            transform: translateY(-8px) rotate(-45deg);
        }


        .sidebar.open {
            left: 0;
        }

        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .sidebar-overlay.show {
            opacity: 1;
            pointer-events: auto;
        }

        .sidebar-content {
            padding: 80px 20px 20px 20px;
        }

        .sidebar-menu {
            list-style: none;
            padding: 0;
            margin: 0 0 20px 0;
        }

        .sidebar-menu-item {
            padding: 16px;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 16px;
            font-weight: 600;
            color: #333;
            transition: all 0.3s;
            border: 2px solid transparent;
            position: relative;
        }

        .sidebar-menu-item:hover {
			background: linear-gradient(135deg, #C8E6C9 0%, #A5D6A7 100%);
			border-color: #4CAF50;
			transform: translateX(4px);
		}

        .sidebar-menu-item.active {
            background: linear-gradient(135deg, #2E7D32 0%, #1B5E20 100%);
            color: white;
        }

        .sidebar-section {
            display: none;
            animation: fadeIn 0.3s;
        }

        .sidebar-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .sidebar-header {
            font-size: 18px;
            font-weight: 700;
            color: #333;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 3px solid #f0f0f0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .history-item {
            padding: 12px;
            background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%);
            border-radius: 12px;
            margin-bottom: 10px;
            border-left: 4px solid #4CAF50;
        }

        .fertilizer-item {
            padding: 12px;
            background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%);
            border-radius: 12px;
            margin-bottom: 10px;
            border-left: 4px solid #FF9800;
        }

        .fertilizer-pond {
            font-size: 14px;
            font-weight: 700;
            color: #E65100;
            margin-bottom: 4px;
        }

        .fertilizer-date {
            font-size: 12px;
            color: #F57C00;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .fertilizer-time {
            font-size: 11px;
            color: #FB8C00;
            margin-top: 2px;
        }

        .history-pond {
            font-size: 14px;
            font-weight: 700;
            color: #2E7D32;
            margin-bottom: 4px;
        }

        .history-date {
            font-size: 12px;
            color: #558B2F;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .history-time {
            font-size: 11px;
            color: #689F38;
            margin-top: 2px;
        }

        .no-history {
            text-align: center;
            padding: 20px;
            color: #999;
            font-size: 13px;
        }

        .clear-history-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #FF5252 0%, #F44336 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 12px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .clear-history-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(244, 67, 54, 0.4);
        }

        .clear-history-btn:active {
            transform: translateY(0);
        }

        .control-item {
            margin-bottom: 16px;
        }

        .control-item .switch-item {
            margin-bottom: 0;
        }

        .container {
            max-width: 480px;
            margin: 0 auto;
        }

        .grow-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 16px;
        }

        .grow-btn {
            padding: 14px 8px;
            background: linear-gradient(135deg, #00E676 0%, #00C853 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 13px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 16px rgba(0, 230, 118, 0.4);
            transition: all 0.3s;
            text-align: center;
        }

        .grow-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 230, 118, 0.5);
        }

        .grow-btn.growing {
            background: linear-gradient(135deg, #FFC107 0%, #FFA000 100%);
            box-shadow: 0 4px 16px rgba(255, 193, 7, 0.4);
        }

        .grow-status {
            font-size: 11px;
            opacity: 0.95;
            margin-top: 4px;
        }



        .timer-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .timer-item {
            background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%);
            padding: 16px;
            border-radius: 12px;
            text-align: left;
            border: 2px solid #81C784;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .timer-item.inactive {
            background: linear-gradient(135deg, #F5F5F5 0%, #E0E0E0 100%);
            border-color: #BDBDBD;
        }

        .timer-label {
            font-size: 14px;
            font-weight: 700;
            color: #2E7D32;
            margin-bottom: 0;
        }

        .timer-item.inactive .timer-label {
            color: #757575;
        }

        .timer-info {
            flex: 1;
        }

        .timer-display {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .timer-value {
            font-size: 20px;
            font-weight: 800;
            color: #1B5E20;
            margin-bottom: 0;
            line-height: 1;
        }

        .timer-item.inactive .timer-value {
            color: #9E9E9E;
        }

        .timer-unit {
            font-size: 10px;
            color: #558B2F;
            font-weight: 600;
        }

        .timer-item.inactive .timer-unit {
            color: #9E9E9E;
        }

        .timer-status {
            font-size: 11px;
            margin-top: 4px;
            padding: 4px 10px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 8px;
            font-weight: 600;
            white-space: nowrap;
        }

        .notification-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #F44336;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 700;
            box-shadow: 0 2px 8px rgba(244, 67, 54, 0.4);
            animation: pulse-notification 2s infinite;
        }

        @keyframes pulse-notification {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .alert-banner {
            background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%);
            border: 2px solid #FF9800;
            border-radius: 12px;
            padding: 12px 16px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
            animation: slideIn 0.3s;
        }

        .alert-banner.harvest {
            background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%);
            border-color: #4CAF50;
        }

        @keyframes slideIn {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .alert-icon {
            font-size: 24px;
        }

        .alert-content {
            flex: 1;
        }

        .alert-title {
            font-size: 14px;
            font-weight: 700;
            color: #E65100;
            margin-bottom: 4px;
        }

        .alert-banner.harvest .alert-title {
            color: #2E7D32;
        }

        .alert-text {
            font-size: 12px;
            color: #F57C00;
        }

        .alert-banner.harvest .alert-text {
            color: #558B2F;
        }

        .alert-close {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #666;
            padding: 0;
            width: 24px;
            height: 24px;
        }


.header {
    background: linear-gradient(135deg, rgba(46, 125, 50, 0.75) 0%, rgba(76, 175, 80, 0.75) 100%), 
                url('https://i.ibb.co/MkmmJcxW/your-image.jpg') 0% center/cover no-repeat;
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    /* Properties ‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏≠‡∏¢‡∏π‡πà */
    color: white;
    padding: 24px;
    border-radius: 20px;
    margin-bottom: 16px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.25);
    position: relative;
    overflow: hidden;
    min-height: 120px;
    background-size: cover;
    background-position: 0% center;
}

        .header-title {
            font-size: 24px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
        }

        .header-status {
            font-size: 13px;
            opacity: 0.95;
            display: flex;
            align-items: center;
            gap: 8px;
            position: relative;
            z-index: 1;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            background: #81C784;
            border-radius: 50%;
            animation: pulse 2s infinite;
            box-shadow: 0 0 12px rgba(129, 199, 132, 0.8);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(0.9); }
        }



        .card-header {
            font-size: 16px;
            font-weight: 700;
            color: #333;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 3px solid #f0f0f0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .temp-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }

        .temp-item {
            background: linear-gradient(135deg, #66BB6A 0%, #4CAF50 100%);
            color: white;
            padding: 12px 8px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.35);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .temp-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(76, 175, 80, 0.45);
        }

        .temp-label {
            font-size: 11px;
            opacity: 0.95;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .temp-value {
            font-size: 24px;
            font-weight: 800;
            line-height: 1;
            margin-bottom: 2px;
        }

        .temp-unit {
            font-size: 12px;
            opacity: 0.9;
            font-weight: 600;
        }
		/* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏•‡∏±‡∏á .temp-unit */
.temp-item.cold {
    background: linear-gradient(135deg, #64B5F6 0%, #42A5F5 100%);
    box-shadow: 0 4px 12px rgba(66, 165, 245, 0.35);
}

.temp-item.cold:hover {
    box-shadow: 0 6px 16px rgba(66, 165, 245, 0.45);
}

.temp-item.hot {
    background: linear-gradient(135deg, #EF5350 0%, #E53935 100%);
    box-shadow: 0 4px 12px rgba(239, 83, 80, 0.35);
}

.temp-item.hot:hover {
    box-shadow: 0 6px 16px rgba(239, 83, 80, 0.45);
}

/* Dark Mode */
/* ‚≠ê ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏ï‡πà‡∏≥ - Dark Mode */
body.dark-mode .temp-item.cold {
    background: linear-gradient(135deg, 
        rgba(100, 181, 246, 0.8) 0%, 
        rgba(66, 165, 245, 0.8) 100%);
    backdrop-filter: blur(25px) saturate(160%);
    -webkit-backdrop-filter: blur(25px) saturate(160%);
    box-shadow: 
        0 4px 12px rgba(66, 165, 245, 0.6),
        inset 0 1px 1px rgba(255, 255, 255, 0.3);
}

body.dark-mode .temp-item.cold:hover {
    box-shadow: 
        0 6px 16px rgba(66, 165, 245, 0.7),
        inset 0 1px 1px rgba(255, 255, 255, 0.4);
}

/* ‚≠ê ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏™‡∏π‡∏á - Dark Mode */
body.dark-mode .temp-item.hot {
    background: linear-gradient(135deg, 
        rgba(239, 83, 80, 0.8) 0%, 
        rgba(229, 57, 53, 0.8) 100%);
    backdrop-filter: blur(25px) saturate(160%);
    -webkit-backdrop-filter: blur(25px) saturate(160%);
    box-shadow: 
        0 4px 12px rgba(239, 83, 80, 0.6),
        inset 0 1px 1px rgba(255, 255, 255, 0.3);
}

body.dark-mode .temp-item.hot:hover {
    box-shadow: 
        0 6px 16px rgba(239, 83, 80, 0.7),
        inset 0 1px 1px rgba(255, 255, 255, 0.4);
}

/* ‚≠ê ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏õ‡∏Å‡∏ï‡∏¥ - Dark Mode */
body.dark-mode .temp-item:not(.cold):not(.hot) {
    background: linear-gradient(135deg, 
        rgba(102, 187, 106, 0.7) 0%, 
        rgba(76, 175, 80, 0.7) 100%);
    backdrop-filter: blur(25px) saturate(160%);
    -webkit-backdrop-filter: blur(25px) saturate(160%);
    box-shadow: 
        0 4px 12px rgba(76, 175, 80, 0.5),
        inset 0 1px 1px rgba(255, 255, 255, 0.3);
}
		.led-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px;
            background: linear-gradient(135deg, #FAFAFA 0%, #F5F5F5 100%);
            border-radius: 12px;
            margin-bottom: 10px;
            border: 2px solid #E8E8E8;
            transition: all 0.3s;
        }

        .led-item:hover {
            border-color: #03A9F4;
            transform: translateX(4px);
        }

        .led-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .led-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #03A9F4;
            box-shadow: 0 0 20px rgba(3, 169, 244, 0.6), inset 0 2px 8px rgba(255, 255, 255, 0.3);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .led-circle.off {
            background: #E0E0E0;
            box-shadow: 0 0 0 rgba(0, 0, 0, 0.1), inset 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        #light-led-menu {
            background: #FDD835;
            box-shadow: 0 0 20px rgba(253, 216, 53, 0.8), inset 0 2px 8px rgba(255, 255, 255, 0.3);
        }

        #light-led-menu.off {
            background: #E0E0E0;
            box-shadow: 0 0 0 rgba(0, 0, 0, 0.1), inset 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        #oxygen-led-menu {
            background: #4CAF50;
            box-shadow: 0 0 20px rgba(76, 175, 80, 0.8), inset 0 2px 8px rgba(255, 255, 255, 0.3);
        }

        #oxygen-led-menu.off {
            background: #E0E0E0;
            box-shadow: 0 0 0 rgba(0, 0, 0, 0.1), inset 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .led-circle::after {
            content: '';
            width: 20px;
            height: 20px;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.8) 0%, transparent 70%);
            border-radius: 50%;
            animation: glow 2s infinite;
        }

        .led-circle.off::after {
            animation: none;
            opacity: 0.3;
        }

        @keyframes glow {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 0.4; }
        }

        .led-info {
            flex: 1;
        }

        .led-label {
            font-size: 15px;
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }

        .led-status {
            font-size: 14px;
            font-weight: 700;
            color: #03A9F4;
            padding: 4px 12px;
            background: #E1F5FE;
            border-radius: 12px;
        }

        .led-status.off {
            color: #F44336;
            background: #FFEBEE;
        }

        .switch-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 18px;
            background: linear-gradient(135deg, #FFF8E1 0%, #FFECB3 100%);
            border-radius: 16px;
            margin-bottom: 12px;
            border: 2px solid #FFE082;
            transition: all 0.3s;
        }

        .switch-item:hover {
            transform: translateX(4px);
            box-shadow: 0 4px 16px rgba(255, 193, 7, 0.3);
        }

        .switch-item.light {
            background: linear-gradient(135deg, #FFF9C4 0%, #FFF59D 100%);
            border-color: #FDD835;
        }

        .switch-item.oxygen {
            background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%);
            border-color: #81C784;
        }

        .switch-item.pump {
            background: linear-gradient(135deg, #E1F5FE 0%, #B3E5FC 100%);
            border-color: #81D4FA;
        }

        .switch-item.pump.disabled {
            background: linear-gradient(135deg, #F5F5F5 0%, #E0E0E0 100%);
            border-color: #BDBDBD;
            opacity: 0.6;
            cursor: not-allowed;
        }

        .switch-item.pump.disabled .toggle {
            cursor: not-allowed;
            opacity: 0.5;
        }

        .switch-left {
            display: flex;
            align-items: center;
            gap: 16px;
            flex: 1;
        }

        .switch-icon {
            font-size: 32px;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
        }

        .switch-info {
            flex: 1;
        }

        .switch-label {
            font-size: 16px;
            font-weight: 700;
            color: #333;
            margin-bottom: 4px;
        }

        .switch-pin {
            font-size: 11px;
            color: #666;
            font-family: 'Courier New', monospace;
        }

        .toggle {
            position: relative;
            width: 64px;
            height: 36px;
            background: #BDBDBD;
            border-radius: 18px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .toggle.active {
            background: #4CAF50;
        }

        .toggle.active.light {
            background: #FDD835;
        }

        .toggle.active.oxygen {
            background: #4CAF50;
        }

        .toggle.active.pump {
            background: #039BE5;
        }

        .toggle-thumb {
            position: absolute;
            top: 4px;
            left: 4px;
            width: 28px;
            height: 28px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.3);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .toggle.active .toggle-thumb {
            transform: translateX(28px);
        }

        .info-box {
            padding: 14px 16px;
            background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%);
            border: 2px solid #FFB74D;
            border-radius: 12px;
            margin-top: 16px;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }

        .info-icon {
            font-size: 20px;
            flex-shrink: 0;
        }

        .info-text {
            font-size: 13px;
            color: #E65100;
            line-height: 1.5;
            font-weight: 500;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: white;
            font-size: 16px;
        }

        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 16px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

.confirm-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    z-index: 9999;
    display: none;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.confirm-overlay.show {
    opacity: 1;
}

.confirm-dialog {
    background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
    border-radius: 24px;
    padding: 32px;
    max-width: 400px;
    width: 90%;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    transform: scale(1);
    opacity: 1;
}

@keyframes popIn {
    from {
        transform: scale(0.9);
        opacity: 0;
    }
    to {
        transform: scale(1);
        opacity: 1;
    }
}
.confirm-icon {
    width: 64px;
    height: 64px;
    margin: 0 auto 20px;
    background: linear-gradient(135deg, #2E7D32 0%, #1B5E20 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 32px;
    box-shadow: 0 8px 24px rgba(46, 125, 50, 0.4);
}

.confirm-icon.warning {
    background: linear-gradient(135deg, #FFC107 0%, #FFA000 100%);
    box-shadow: 0 8px 24px rgba(255, 193, 7, 0.4);
}

.confirm-icon.danger {
    background: linear-gradient(135deg, #FF5252 0%, #F44336 100%);
    box-shadow: 0 8px 24px rgba(244, 67, 54, 0.4);
}

.confirm-title {
    font-size: 22px;
    font-weight: 700;
    color: #333;
    text-align: center;
    margin-bottom: 12px;
}

.confirm-message {
    font-size: 15px;
    color: #666;
    text-align: center;
    line-height: 1.6;
    margin-bottom: 28px;
}

.confirm-buttons {
    display: flex;
    gap: 12px;
}

.confirm-btn {
    flex: 1;
    padding: 14px 24px;
    border: none;
    border-radius: 12px;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.confirm-btn.cancel {
    background: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%);
    color: #666;
}

.confirm-btn.cancel:hover {
    background: linear-gradient(135deg, #e8e8e8 0%, #d0d0d0 100%);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.confirm-btn.confirm {
    background: linear-gradient(135deg, #2E7D32 0%, #1B5E20 100%);
    color: white;
}

.confirm-btn.confirm:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(46, 125, 50, 0.4);
}

.confirm-btn.danger {
    background: linear-gradient(135deg, #FF5252 0%, #F44336 100%);
    color: white;
}

.confirm-btn.danger:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(244, 67, 54, 0.4);
}

.confirm-btn:active {
    transform: translateY(0);
}

body.dark-mode {
    background: url('https://i.ibb.co/qFpvskFp/dark-green-blue-grainy-gradient-260nw-2628008543.jpg') center/cover fixed;
    position: relative;
}

body.dark-mode::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: url('https://i.ibb.co/qFpvskFp/dark-green-blue-grainy-gradient-260nw-2628008543.jpg') center/cover fixed;
    filter: blur(20px);
    z-index: -1;
}

body.dark-mode .confirm-overlay {
    background: rgba(0, 0, 0, 0.8);
}

body.dark-mode .confirm-dialog {
    background: rgba(0, 0, 0, 0.3);
    backdrop-filter: blur(30px);
    -webkit-backdrop-filter: blur(30px);
    border: 1px solid rgba(255, 255, 255, 0.25);
}

body.dark-mode .confirm-title {
    color: #ffffff;
}

body.dark-mode .confirm-message {
    color: #b0b0b0;
}

body.dark-mode .confirm-btn.cancel {
    background: linear-gradient(135deg, #3a3a4e 0%, #2a2a3e 100%);
    color: #ffffff;
}

body.dark-mode .confirm-btn.cancel:hover {
    background: linear-gradient(135deg, #4a4a5e 0%, #3a3a4e 100%);
}

body.dark-mode .header {
    background: linear-gradient(135deg, rgba(46, 125, 50, 0.75) 0%, rgba(76, 175, 80, 0.75) 100%), 
                url('https://i.ibb.co/MkmmJcxW/your-image.jpg') 0% center/cover no-repeat;
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.3);
}

/* ===================================
   üåô DARK MODE - Liquid Glass
   =================================== */

body.dark-mode .card,
body.dark-mode .timer-card {
    background: rgba(0, 0, 0, 0.25);
    backdrop-filter: blur(30px) saturate(150%);
    -webkit-backdrop-filter: blur(30px) saturate(150%);
    border: 1px solid rgba(255, 255, 255, 0.15);
    box-shadow: 
        0 8px 32px rgba(0, 0, 0, 0.3),
        inset 0 1px 1px rgba(255, 255, 255, 0.1);
}

body.dark-mode .sidebar {
    background: rgba(0, 0, 0, 0.3);
    backdrop-filter: blur(40px) saturate(180%);
    -webkit-backdrop-filter: blur(40px) saturate(180%);
    border-right: 1px solid rgba(255, 255, 255, 0.2);
}

body.dark-mode .sidebar-menu-item {
    background: rgba(255, 255, 255, 0.08);
    backdrop-filter: blur(20px) saturate(150%);
    -webkit-backdrop-filter: blur(20px) saturate(150%);
    border: 1px solid rgba(255, 255, 255, 0.15);
    box-shadow: 
        0 2px 10px rgba(0, 0, 0, 0.2),
        inset 0 1px 1px rgba(255, 255, 255, 0.1);
}

body.dark-mode .sidebar-menu-item:hover {
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(25px) saturate(180%);
    -webkit-backdrop-filter: blur(25px) saturate(180%);
    box-shadow: 
        0 4px 15px rgba(76, 175, 80, 0.3),
        inset 0 1px 1px rgba(255, 255, 255, 0.2);
}

body.dark-mode .hamburger-btn {
    background: rgba(0, 0, 0, 0.35);
    backdrop-filter: blur(25px) saturate(180%);
    -webkit-backdrop-filter: blur(25px) saturate(180%);
    border: 1px solid rgba(255, 255, 255, 0.25);
}

body.dark-mode .switch-item {
    background: rgba(0, 0, 0, 0.25);
    backdrop-filter: blur(20px) saturate(150%);
    -webkit-backdrop-filter: blur(20px) saturate(150%);
    border-color: rgba(255, 224, 130, 0.3);
}

body.dark-mode .led-item {
    background: rgba(0, 0, 0, 0.25);
    backdrop-filter: blur(20px) saturate(150%);
    -webkit-backdrop-filter: blur(20px) saturate(150%);
    border-color: rgba(255, 255, 255, 0.15);
}

body.dark-mode .settings-item {
    background: rgba(0, 0, 0, 0.25);
    backdrop-filter: blur(20px) saturate(150%);
    -webkit-backdrop-filter: blur(20px) saturate(150%);
    border-color: rgba(255, 255, 255, 0.15);
}

body.dark-mode .settings-option {
    background: rgba(255, 255, 255, 0.08);
    backdrop-filter: blur(15px) saturate(150%);
    -webkit-backdrop-filter: blur(15px) saturate(150%);
    border: 1px solid rgba(255, 255, 255, 0.1);
}

body.dark-mode .timer-item {
    background: rgba(0, 0, 0, 0.25);
    backdrop-filter: blur(25px) saturate(160%);
    -webkit-backdrop-filter: blur(25px) saturate(160%);
    border-color: rgba(76, 175, 80, 0.4);
}

body.dark-mode .confirm-dialog {
    background: rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(40px) saturate(180%);
    -webkit-backdrop-filter: blur(40px) saturate(180%);
    border: 1px solid rgba(255, 255, 255, 0.2);
}

body.dark-mode .card-header,
body.dark-mode .sidebar-header {
    color: #ffffff;
    border-bottom-color: rgba(255, 255, 255, 0.1);
}

body.dark-mode .sidebar {
    background: rgba(0, 0, 0, 0.25);
    backdrop-filter: blur(25px);
    -webkit-backdrop-filter: blur(25px);
    border-right-color: rgba(255, 255, 255, 0.2);
}

body.dark-mode .sidebar-menu-item {
    background: rgba(0, 0, 0, 0.2);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    color: #ffffff;
    border: 1px solid rgba(255, 255, 255, 0.15);
}

body.dark-mode .sidebar-menu-item:hover {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
}

body.dark-mode .sidebar-menu-item.active {
    background: linear-gradient(135deg, #2E7D32 0%, #1B5E20 100%);
}

body.dark-mode .hamburger-btn {
    background: rgba(0, 0, 0, 0.3);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    border-color: rgba(255, 255, 255, 0.3);
}

body.dark-mode .hamburger-line {
    background: #81C784;
}

body.dark-mode .switch-label,
body.dark-mode .led-label,
body.dark-mode .timer-label {
    color: #ffffff;
}

body.dark-mode .switch-pin,
body.dark-mode .timer-unit {
    color: #b0b0b0;
}

body.dark-mode .info-box {
    background: linear-gradient(135deg, #3a3a2e 0%, #2a2a1e 100%);
    border-color: #FFB74D;
}

body.dark-mode .info-text {
    color: #FFD54F;
}

body.dark-mode .timer-item {
    background: rgba(0, 0, 0, 0.2);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border-color: #4CAF50;
}

body.dark-mode .timer-item.inactive {
    background: rgba(0, 0, 0, 0.15);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border-color: #555;
}

body.dark-mode .timer-value {
    color: #81C784;
}

body.dark-mode .timer-item.inactive .timer-value {
    color: #666;
}

body.dark-mode .grow-btn {
    box-shadow: 0 4px 16px rgba(0, 230, 118, 0.6);
}

body.dark-mode .grow-btn.growing {
    box-shadow: 0 4px 16px rgba(255, 193, 7, 0.6);
}

body.dark-mode .led-item {
    background: rgba(0, 0, 0, 0.2);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-color: rgba(255, 255, 255, 0.15);
}

body.dark-mode .led-status {
    background: rgba(3, 169, 244, 0.2);
    color: #4FC3F7;
}

body.dark-mode .led-status.off {
    background: rgba(244, 67, 54, 0.2);
    color: #EF5350;
}

body.dark-mode .switch-item {
    background: rgba(0, 0, 0, 0.2);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-color: rgba(255, 224, 130, 0.3);
}

body.dark-mode .switch-item.light {
    background: linear-gradient(135deg, #3a3a2e 0%, #2a2a1e 100%);
    border-color: rgba(253, 216, 53, 0.4);
}

body.dark-mode .switch-item.oxygen {
    background: linear-gradient(135deg, #2a3a2e 0%, #1a2a1e 100%);
    border-color: rgba(129, 199, 132, 0.4);
}

body.dark-mode .switch-item.pump {
    background: linear-gradient(135deg, #2a2a3e 0%, #1a1a2e 100%);
    border-color: rgba(129, 212, 250, 0.4);
}

body.dark-mode .temp-item {
    box-shadow: 0 4px 12px rgba(76, 175, 80, 0.5);
}

body.dark-mode .history-item,
body.dark-mode .fertilizer-item {
    background: linear-gradient(135deg, #2a3a2e 0%, #1a2a1e 100%);
}

body.dark-mode .no-history {
    color: #666;
}
body.dark-mode .no-history {
    color: #666;
}

/* ===================================
   üíé LIQUID GLASS - ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÄ‡∏°‡∏ô‡∏π
   =================================== */

/* ‚≠ê No History Message */
.no-history {
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(15px) saturate(140%);
    -webkit-backdrop-filter: blur(15px) saturate(140%);
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 12px;
    padding: 20px;
    box-shadow: 
        0 2px 8px rgba(0, 0, 0, 0.05),
        inset 0 1px 1px rgba(255, 255, 255, 0.4);
}

/* ‚≠ê Clear History Button */
.clear-history-btn {
    background: linear-gradient(135deg, 
        rgba(255, 82, 82, 0.9) 0%, 
        rgba(244, 67, 54, 0.9) 100%);
    backdrop-filter: blur(20px) saturate(150%);
    -webkit-backdrop-filter: blur(20px) saturate(150%);
    border: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow: 
        0 4px 15px rgba(244, 67, 54, 0.3),
        inset 0 1px 1px rgba(255, 255, 255, 0.4);
}

/* ‚≠ê Grow Buttons */
.grow-btn {
    background: linear-gradient(135deg, 
        rgba(0, 230, 118, 0.9) 0%, 
        rgba(0, 200, 83, 0.9) 100%);
    backdrop-filter: blur(20px) saturate(150%);
    -webkit-backdrop-filter: blur(20px) saturate(150%);
    border: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow: 
        0 4px 16px rgba(0, 230, 118, 0.4),
        inset 0 1px 1px rgba(255, 255, 255, 0.4);
}

.grow-btn.growing {
    background: linear-gradient(135deg, 
        rgba(255, 193, 7, 0.9) 0%, 
        rgba(255, 160, 0, 0.9) 100%);
    backdrop-filter: blur(20px) saturate(150%);
    -webkit-backdrop-filter: blur(20px) saturate(150%);
    box-shadow: 
        0 4px 16px rgba(255, 193, 7, 0.4),
        inset 0 1px 1px rgba(255, 255, 255, 0.4);
}

/* ‚≠ê Temperature Items */
.temp-item {
    background: linear-gradient(135deg, 
        rgba(102, 187, 106, 0.9) 0%, 
        rgba(76, 175, 80, 0.9) 100%);
    backdrop-filter: blur(25px) saturate(160%);
    -webkit-backdrop-filter: blur(25px) saturate(160%);
    border: 1px solid rgba(255, 255, 255, 0.4);
    box-shadow: 
        0 4px 12px rgba(76, 175, 80, 0.35),
        inset 0 1px 1px rgba(255, 255, 255, 0.5);
}

/* ‚≠ê Confirm Time Button */
.confirm-time-btn {
    background: linear-gradient(135deg, 
        rgba(76, 175, 80, 0.9) 0%, 
        rgba(56, 142, 60, 0.9) 100%);
    backdrop-filter: blur(20px) saturate(150%);
    -webkit-backdrop-filter: blur(20px) saturate(150%);
    border: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow: 
        0 4px 16px rgba(76, 175, 80, 0.4),
        inset 0 1px 1px rgba(255, 255, 255, 0.4);
}

/* ===================================
   üåô DARK MODE - ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°
   =================================== */

body.dark-mode .no-history {
    background: rgba(0, 0, 0, 0.2);
    backdrop-filter: blur(15px) saturate(140%);
    -webkit-backdrop-filter: blur(15px) saturate(140%);
    border: 1px solid rgba(255, 255, 255, 0.15);
    box-shadow: 
        0 2px 8px rgba(0, 0, 0, 0.2),
        inset 0 1px 1px rgba(255, 255, 255, 0.1);
    color: #666;
}

body.dark-mode .clear-history-btn {
    background: linear-gradient(135deg, 
        rgba(255, 82, 82, 0.8) 0%, 
        rgba(244, 67, 54, 0.8) 100%);
    backdrop-filter: blur(20px) saturate(150%);
    -webkit-backdrop-filter: blur(20px) saturate(150%);
    box-shadow: 
        0 4px 15px rgba(244, 67, 54, 0.5),
        inset 0 1px 1px rgba(255, 255, 255, 0.3);
}

body.dark-mode .grow-btn {
    background: linear-gradient(135deg, 
        rgba(0, 230, 118, 0.8) 0%, 
        rgba(0, 200, 83, 0.8) 100%);
    backdrop-filter: blur(20px) saturate(150%);
    -webkit-backdrop-filter: blur(20px) saturate(150%);
    box-shadow: 
        0 4px 16px rgba(0, 230, 118, 0.6),
        inset 0 1px 1px rgba(255, 255, 255, 0.3);
}

body.dark-mode .grow-btn.growing {
    background: linear-gradient(135deg, 
        rgba(255, 193, 7, 0.8) 0%, 
        rgba(255, 160, 0, 0.8) 100%);
    backdrop-filter: blur(20px) saturate(150%);
    -webkit-backdrop-filter: blur(20px) saturate(150%);
    box-shadow: 
        0 4px 16px rgba(255, 193, 7, 0.6),
        inset 0 1px 1px rgba(255, 255, 255, 0.3);
}

body.dark-mode .temp-item {
    background: linear-gradient(135deg, 
        rgba(102, 187, 106, 0.7) 0%, 
        rgba(76, 175, 80, 0.7) 100%);
    backdrop-filter: blur(25px) saturate(160%);
    -webkit-backdrop-filter: blur(25px) saturate(160%);
    box-shadow: 
        0 4px 12px rgba(76, 175, 80, 0.5),
        inset 0 1px 1px rgba(255, 255, 255, 0.3);
}

body.dark-mode .confirm-time-btn {
    background: linear-gradient(135deg, 
        rgba(76, 175, 80, 0.8) 0%, 
        rgba(56, 142, 60, 0.8) 100%);
    backdrop-filter: blur(20px) saturate(150%);
    -webkit-backdrop-filter: blur(20px) saturate(150%);
    box-shadow: 
        0 4px 16px rgba(76, 175, 80, 0.6),
        inset 0 1px 1px rgba(255, 255, 255, 0.3);
}

/* ‡∏ï‡πà‡∏≠‡∏î‡πâ‡∏ß‡∏¢ .settings-item ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏î‡∏¥‡∏°... */

.settings-item {
    padding: 16px;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    border-radius: 12px;
    margin-bottom: 10px;
    border: 2px solid #E8E8E8;
    transition: all 0.3s;
}

.settings-item:hover {
    border-color: #64B5F6;
    transform: translateX(4px);
}

.settings-item-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    cursor: pointer;
}

.settings-item-left {
    display: flex;
    align-items: center;
    gap: 12px;
    flex: 1;
}

.settings-icon {
    font-size: 24px;
}

.settings-label {
    font-size: 15px;
    font-weight: 600;
    color: #333;
}

.settings-desc {
    font-size: 12px;
    color: #666;
    margin-top: 2px;
}

.settings-arrow {
    font-size: 18px;
    color: #999;
    transition: transform 0.3s;
}

.settings-item.expanded .settings-arrow {
    transform: rotate(90deg);
}

.settings-content {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease-out;
    margin-top: 0;
}

.settings-item.expanded .settings-content {
    max-height: 800px;
    margin-top: 12px;
    padding-top: 12px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.confirm-time-btn {
    width: 100%;
    padding: 14px 24px;
    background: linear-gradient(135deg, #4CAF50 0%, #388E3C 100%);
    color: white;
    border: none;
    border-radius: 12px;
    font-size: 15px;
    font-weight: 700;
    cursor: pointer;
    box-shadow: 0 4px 16px rgba(76, 175, 80, 0.4);
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    margin-top: 16px;
}

.confirm-time-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(76, 175, 80, 0.6);
}

.confirm-time-btn:active {
    transform: translateY(0);
}

body.dark-mode .confirm-time-btn {
    box-shadow: 0 4px 16px rgba(76, 175, 80, 0.6);
}

body.dark-mode .confirm-time-btn:hover {
    box-shadow: 0 6px 20px rgba(76, 175, 80, 0.8);
}

.settings-option {
    padding: 10px 12px;
    background: white;
    border-radius: 8px;
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.settings-option-label {
    font-size: 14px;
    color: #555;
}

.settings-value {
    font-size: 13px;
    font-weight: 600;
    color: #2E7D32;
}

body.dark-mode .settings-item {
    background: rgba(0, 0, 0, 0.2);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-color: rgba(255, 255, 255, 0.15);
}

body.dark-mode .settings-item:hover {
    border-color: #64B5F6;
}

body.dark-mode .settings-label {
    color: #ffffff;
}

body.dark-mode .settings-desc {
    color: #b0b0b0;
}

body.dark-mode .settings-option {
    background: rgba(0, 0, 0, 0.15);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
}

body.dark-mode .settings-option-label {
    color: #b0b0b0;
}

body.dark-mode .settings-content {
    border-top-color: rgba(255, 255, 255, 0.1);
}
    </style>
</head><body>
    <button class="hamburger-btn" id="hamburger-btn" onclick="toggleSidebar()">
        <div class="hamburger-line"></div>
        <div class="hamburger-line"></div>
        <div class="hamburger-line"></div>
    </button>

    <div class="sidebar-overlay" id="sidebar-overlay" onclick="toggleSidebar()"></div>

    <div class="sidebar" id="sidebar">
        <div class="sidebar-content">
            <ul class="sidebar-menu">
                <li class="sidebar-menu-item active" onclick="showSection('history')">
                    <span>üìã</span>
                    <span>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß</span>
                </li>
                <li class="sidebar-menu-item" onclick="showSection('fertilizer')">
                    <span>üåæ</span>
                    <span>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢</span>
                    <div class="notification-badge" id="fertilizer-badge" style="display: none;">0</div>
                </li>
                <li class="sidebar-menu-item" onclick="showSection('control')">
                    <span>üéÆ</span>
                    <span>‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°</span>
                </li>
                <li class="sidebar-menu-item" onclick="showSection('settings')">
                    <span>‚öôÔ∏è</span>
                    <span>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</span>
                </li>
            </ul>

            <!-- ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö -->
            <div class="sidebar-section active" id="section-history">
                <div class="sidebar-header">
                    <span>üìã</span>
                    <span>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß</span>
                </div>
                <div id="history-list">
                    <div class="no-history">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß</div>
                </div>
                <button class="clear-history-btn" onclick="clearHistory()">
                    <span>üóëÔ∏è</span>
                    <span>‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
                </button>
            </div>

            <!-- ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢ -->
            <div class="sidebar-section" id="section-fertilizer">
                <div class="sidebar-header">
                    <span>üåæ</span>
                    <span>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢</span>
                </div>
                <div id="fertilizer-list">
                    <div class="no-history">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢</div>
                </div>
                <button class="clear-history-btn" onclick="clearFertilizerHistory()">
                    <span>üóëÔ∏è</span>
                    <span>‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
                </button>
            </div>

            <!-- ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° -->
            <div class="sidebar-section" id="section-control">
                <div class="sidebar-header">
                    <span>üéÆ</span>
                    <span>‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°</span>
                </div>
                
<div class="switch-item light" style="margin-bottom: 12px;">
    <div class="switch-left">
        <div class="led-circle off" id="light-led-menu"></div>
        <div class="switch-icon">üí°</div>
        <div class="switch-info">
            <div class="switch-label">‡πÑ‡∏ü</div>
            <div class="switch-pin" id="light-mode-display">‡πÇ‡∏´‡∏°‡∏î: AUTO</div>
        </div>
    </div>
    
    <!-- Toggle ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ (‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Å‡∏î) -->
    <div class="toggle light" id="light-status-toggle" style="pointer-events: none; opacity: 0.7;">
        <div class="toggle-thumb"></div>
    </div>
    
    <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏•‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î -->
    <button onclick="toggleLightMode()" 
            style="padding: 8px 16px; background: linear-gradient(135deg, #FDD835 0%, #F9A825 100%); 
                   color: white; border: none; border-radius: 8px; font-weight: 600; 
                   font-size: 12px; cursor: pointer; margin-left: 8px;">
        <span id="light-mode-btn">AUTO</span>
    </button>
</div>

<div class="switch-item oxygen" style="margin-bottom: 12px;">
    <div class="switch-left">
        <div class="led-circle" id="oxygen-led-menu"></div>
        <div class="switch-icon">üí®</div>
        <div class="switch-info">
            <div class="switch-label">‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô</div>
            <div class="switch-pin" id="oxygen-mode-display">‡πÇ‡∏´‡∏°‡∏î: AUTO</div>
        </div>
    </div>
    
    <!-- Toggle ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ (‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Å‡∏î) -->
    <div class="toggle oxygen active" id="oxygen-status-toggle" style="pointer-events: none; opacity: 0.7;">
        <div class="toggle-thumb"></div>
    </div>
    
    <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏•‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î -->
    <button onclick="toggleOxygenMode()" 
            style="padding: 8px 16px; background: linear-gradient(135deg, #4CAF50 0%, #388E3C 100%); 
                   color: white; border: none; border-radius: 8px; font-weight: 600; 
                   font-size: 12px; cursor: pointer; margin-left: 8px;">
        <span id="oxygen-mode-btn">AUTO</span>
    </button>
</div>
            </div>

            <!-- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ -->
            <div class="sidebar-section" id="section-settings">
                <div class="sidebar-header">
                    <span>‚öôÔ∏è</span>
                    <span>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</span>
                </div>
                
                <!-- ‡πÇ‡∏´‡∏°‡∏î‡∏°‡∏∑‡∏î -->
                <div class="switch-item" style="margin-bottom: 12px; background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%); border-color: #64B5F6;">
                    <div class="switch-left">
                        <div class="switch-icon">üåô</div>
                        <div class="switch-info">
                            <div class="switch-label">‡πÇ‡∏´‡∏°‡∏î‡∏°‡∏∑‡∏î</div>
                            <div class="switch-pin">Dark Mode</div>
                        </div>
                    </div>
                    <div class="toggle" id="darkmode-toggle" onclick="toggleDarkMode()" style="cursor: pointer;">
                        <div class="toggle-thumb">üåô</div>
                    </div>
                </div>

                <!-- ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô -->
                <div class="settings-item" onclick="toggleSettingsItem(this)">
                    <div class="settings-item-header">
                        <div class="settings-item-left">
                            <div class="settings-icon">üîî</div>
                            <div>
                                <div class="settings-label">‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</div>
                                <div class="settings-desc">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ï‡πà‡∏≤‡∏á‡πÜ</div>
                            </div>
                        </div>
                        <div class="settings-arrow">‚Ä∫</div>
                    </div>
                    <div class="settings-content">
                        <div class="settings-option">
                            <span class="settings-option-label">‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</span>
                            <div class="toggle" id="sound-toggle" onclick="event.stopPropagation(); toggleSound();" style="cursor: pointer;">
                                <div class="toggle-thumb"></div>
                            </div>
                        </div>
                        <div class="settings-option">
                            <span class="settings-option-label">üîî Web Notification</span>
                            <div class="toggle" id="web-notif-toggle" onclick="event.stopPropagation(); toggleWebNotification();" style="cursor: pointer;">
                                <div class="toggle-thumb"></div>
                            </div>
                        </div>
						<div style="margin-top: 12px; padding: 10px; background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%); border-radius: 8px; font-size: 11px; color: #1976D2; line-height: 1.6;">
                            üí° <strong>Web Notification</strong> ‡∏à‡∏∞‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏°‡πâ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå)
                        </div>
                        <div class="settings-option">
                            <span class="settings-option-label">‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß</span>
                            <div class="toggle active" id="harvest-notif-toggle" onclick="event.stopPropagation(); toggleHarvestNotif();" style="cursor: pointer;">
                                <div class="toggle-thumb"></div>
                            </div>
                        </div>
                        <div class="settings-option">
                            <span class="settings-option-label">‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢</span>
                            <div class="toggle active" id="fertilizer-notif-toggle" onclick="event.stopPropagation(); toggleFertilizerNotif();" style="cursor: pointer;">
                                <div class="toggle-thumb"></div>
                            </div>
                        </div>
                        
						<div class="settings-option">
    <span class="settings-option-label">üå°Ô∏è ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥</span>
    <div class="toggle active" id="temperature-notif-toggle" onclick="event.stopPropagation(); toggleTemperatureNotif();" style="cursor: pointer;">
        <div class="toggle-thumb"></div>
    </div>
</div>
<div style="margin-top: 8px; padding: 10px; background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%); border-radius: 8px; font-size: 11px; color: #E65100; line-height: 1.6;">
    üå°Ô∏è <strong>‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥</strong> ‡∏à‡∏∞‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 20¬∞C ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤ 28¬∞C
</div>
                    </div>
                </div>
					

<!-- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ -->
<div class="settings-item" onclick="toggleSettingsItem(this)">
    <div class="settings-item-header">
        <div class="settings-item-left">
            <div class="settings-icon">‚è±Ô∏è</div>
            <div>
                <div class="settings-label">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤</div>
                <div class="settings-desc">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡πÅ‡∏•‡∏∞‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢</div>
            </div>
        </div>
        <div class="settings-arrow">‚Ä∫</div>
    </div>
    <div class="settings-content">
        <!-- ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß -->
        <div style="margin-bottom: 16px; padding: 12px; background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%); border-radius: 10px; border: 2px solid #4CAF50;">
            <div style="font-size: 14px; font-weight: 700; color: #2E7D32; margin-bottom: 10px; display: flex; align-items: center; gap: 8px;">
                <span>üå±</span>
                <span>‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß</span>
            </div>
            <div class="settings-option" style="background: white; margin-bottom: 8px;">
                <span class="settings-option-label">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</span>
                <select id="harvest-days" 
                       onclick="event.stopPropagation();"
                       style="padding: 6px 12px; border: 2px solid #4CAF50; border-radius: 8px; font-weight: 600; color: #2E7D32; font-size: 14px; background: white; cursor: pointer;">
                    <option value="0">0 ‡∏ß‡∏±‡∏ô</option>
                    <option value="1">1 ‡∏ß‡∏±‡∏ô</option>
                    <option value="2">2 ‡∏ß‡∏±‡∏ô</option>
                    <option value="3">3 ‡∏ß‡∏±‡∏ô</option>
                    <option value="4">4 ‡∏ß‡∏±‡∏ô</option>
                    <option value="5">5 ‡∏ß‡∏±‡∏ô</option>
                    <option value="6">6 ‡∏ß‡∏±‡∏ô</option>
                    <option value="7" selected>7 ‡∏ß‡∏±‡∏ô</option>
                    <option value="8">8 ‡∏ß‡∏±‡∏ô</option>
                    <option value="9">9 ‡∏ß‡∏±‡∏ô</option>
                    <option value="10">10 ‡∏ß‡∏±‡∏ô</option>
                    <option value="11">11 ‡∏ß‡∏±‡∏ô</option>
                    <option value="12">12 ‡∏ß‡∏±‡∏ô</option>
                    <option value="13">13 ‡∏ß‡∏±‡∏ô</option>
                    <option value="14">14 ‡∏ß‡∏±‡∏ô</option>
                    <option value="15">15 ‡∏ß‡∏±‡∏ô</option>
                    <option value="16">16 ‡∏ß‡∏±‡∏ô</option>
                    <option value="17">17 ‡∏ß‡∏±‡∏ô</option>
                    <option value="18">18 ‡∏ß‡∏±‡∏ô</option>
                    <option value="19">19 ‡∏ß‡∏±‡∏ô</option>
                    <option value="20">20 ‡∏ß‡∏±‡∏ô</option>
                    <option value="21">21 ‡∏ß‡∏±‡∏ô</option>
                    <option value="22">22 ‡∏ß‡∏±‡∏ô</option>
                    <option value="23">23 ‡∏ß‡∏±‡∏ô</option>
                    <option value="24">24 ‡∏ß‡∏±‡∏ô</option>
                    <option value="25">25 ‡∏ß‡∏±‡∏ô</option>
                    <option value="26">26 ‡∏ß‡∏±‡∏ô</option>
                    <option value="27">27 ‡∏ß‡∏±‡∏ô</option>
                    <option value="28">28 ‡∏ß‡∏±‡∏ô</option>
                    <option value="29">29 ‡∏ß‡∏±‡∏ô</option>
                    <option value="30">30 ‡∏ß‡∏±‡∏ô</option>
                </select>
            </div>
<div class="settings-option" style="background: white;">
    <span class="settings-option-label">üïê ‡πÄ‡∏ß‡∏•‡∏≤</span>
    <input type="time" id="harvest-time" value="12:00"
           onclick="event.stopPropagation();"
           style="padding: 6px 12px; border: 2px solid #4CAF50; border-radius: 8px; font-weight: 600; color: #2E7D32; font-size: 14px; background: white; cursor: pointer;">
</div>
            <div style="margin-top: 8px; padding: 8px; background: rgba(255, 255, 255, 0.7); border-radius: 6px; font-size: 11px; color: #2E7D32;">
                üí° ‡∏ô‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å‡πÑ‡∏õ‡∏≠‡∏µ‡∏Å <strong id="harvest-example-text">7 ‡∏ß‡∏±‡∏ô ‡πÄ‡∏ß‡∏•‡∏≤ 12:00 ‡∏ô.</strong>
            </div>
        </div>

        <!-- ‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢ -->
        <div style="padding: 12px; background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%); border-radius: 10px; border: 2px solid #FF9800; margin-bottom: 16px;">
            <div style="font-size: 14px; font-weight: 700; color: #E65100; margin-bottom: 10px; display: flex; align-items: center; gap: 8px;">
                <span>üåæ</span>
                <span>‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢</span>
            </div>
            <div class="settings-option" style="background: white; margin-bottom: 8px;">
                <span class="settings-option-label">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</span>
                <select id="fertilizer-days" 
                       onclick="event.stopPropagation();"
                       style="padding: 6px 12px; border: 2px solid #FF9800; border-radius: 8px; font-weight: 600; color: #E65100; font-size: 14px; background: white; cursor: pointer;">
                    <option value="0">0 ‡∏ß‡∏±‡∏ô</option>
                    <option value="1">1 ‡∏ß‡∏±‡∏ô</option>
                    <option value="2">2 ‡∏ß‡∏±‡∏ô</option>
                    <option value="3">3 ‡∏ß‡∏±‡∏ô</option>
                    <option value="4">4 ‡∏ß‡∏±‡∏ô</option>
                    <option value="5">5 ‡∏ß‡∏±‡∏ô</option>
                    <option value="6">6 ‡∏ß‡∏±‡∏ô</option>
                    <option value="7" selected>7 ‡∏ß‡∏±‡∏ô</option>
                    <option value="8">8 ‡∏ß‡∏±‡∏ô</option>
                    <option value="9">9 ‡∏ß‡∏±‡∏ô</option>
                    <option value="10">10 ‡∏ß‡∏±‡∏ô</option>
                    <option value="11">11 ‡∏ß‡∏±‡∏ô</option>
                    <option value="12">12 ‡∏ß‡∏±‡∏ô</option>
                    <option value="13">13 ‡∏ß‡∏±‡∏ô</option>
                    <option value="14">14 ‡∏ß‡∏±‡∏ô</option>
                    <option value="15">15 ‡∏ß‡∏±‡∏ô</option>
                    <option value="16">16 ‡∏ß‡∏±‡∏ô</option>
                    <option value="17">17 ‡∏ß‡∏±‡∏ô</option>
                    <option value="18">18 ‡∏ß‡∏±‡∏ô</option>
                    <option value="19">19 ‡∏ß‡∏±‡∏ô</option>
                    <option value="20">20 ‡∏ß‡∏±‡∏ô</option>
                    <option value="21">21 ‡∏ß‡∏±‡∏ô</option>
                    <option value="22">22 ‡∏ß‡∏±‡∏ô</option>
                    <option value="23">23 ‡∏ß‡∏±‡∏ô</option>
                    <option value="24">24 ‡∏ß‡∏±‡∏ô</option>
                    <option value="25">25 ‡∏ß‡∏±‡∏ô</option>
                    <option value="26">26 ‡∏ß‡∏±‡∏ô</option>
                    <option value="27">27 ‡∏ß‡∏±‡∏ô</option>
                    <option value="28">28 ‡∏ß‡∏±‡∏ô</option>
                    <option value="29">29 ‡∏ß‡∏±‡∏ô</option>
                    <option value="30">30 ‡∏ß‡∏±‡∏ô</option>
                </select>
            </div>
<div class="settings-option" style="background: white;">
    <span class="settings-option-label">üïê ‡πÄ‡∏ß‡∏•‡∏≤</span>
    <input type="time" id="fertilizer-time" value="14:00"
           onclick="event.stopPropagation();"
           style="padding: 6px 12px; border: 2px solid #FF9800; border-radius: 8px; font-weight: 600; color: #E65100; font-size: 14px; background: white; cursor: pointer;">
</div>
<div style="margin-top: 8px; padding: 8px; background: rgba(255, 255, 255, 0.7); border-radius: 6px; font-size: 11px; color: #E65100;">
    üí° ‡∏ô‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà<strong>‡∏õ‡∏•‡∏π‡∏Å</strong>‡πÑ‡∏õ‡∏≠‡∏µ‡∏Å <strong id="fertilizer-example-text">7 ‡∏ß‡∏±‡∏ô ‡πÄ‡∏ß‡∏•‡∏≤ 14:00 ‡∏ô.</strong>
</div>

        </div>

        <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô -->
        <button class="confirm-time-btn" onclick="event.stopPropagation(); confirmTimeSettings();">
            <span>‚úì</span>
            <span>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</span>
        </button>
    </div>
</div>

<!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏ö‡∏ö -->
                <div class="settings-item" onclick="toggleSettingsItem(this)">
                    <div class="settings-item-header">
                        <div class="settings-item-left">
                            <div class="settings-icon">üìä</div>
                            <div>
                                <div class="settings-label">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏ö‡∏ö</div>
                                <div class="settings-desc">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏≠‡∏õ</div>
                            </div>
                        </div>
                        <div class="settings-arrow">‚Ä∫</div>
                    </div>
                    <div class="settings-content">
                        <div class="settings-option">
                            <span class="settings-option-label">‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô</span>
                            <span class="settings-value">v1.0.0</span>
                        </div>
                        <div class="settings-option">
                            <span class="settings-option-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</span>
                            <span class="settings-value" id="connection-status">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...</span>
                        </div>
                        <div class="settings-option">
                            <span class="settings-option-label">‡πÇ‡∏´‡∏°‡∏î</span>
                            <span class="settings-value" id="mode-status">‡∏õ‡∏Å‡∏ï‡∏¥</span>
                        </div>
                    </div>
                </div>

                <!-- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
                <div class="settings-item" onclick="toggleSettingsItem(this)">
                    <div class="settings-item-header">
                        <div class="settings-item-left">
                            <div class="settings-icon">üóëÔ∏è</div>
                            <div>
                                <div class="settings-label">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>
                                <div class="settings-desc">‡∏•‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>
                            </div>
                        </div>
                        <div class="settings-arrow">‚Ä∫</div>
                    </div>
                    <div class="settings-content">
                        <button class="clear-history-btn" onclick="event.stopPropagation(); resetAllData();" style="margin-top: 0;">
                            <span>üîÑ</span>
                            <span>‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Custom Confirm Dialog -->
    <div class="confirm-overlay" id="confirm-overlay">
        <div class="confirm-dialog">
            <div class="confirm-icon" id="confirm-icon">‚ùì</div>
            <div class="confirm-title" id="confirm-title">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</div>
            <div class="confirm-message" id="confirm-message">‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?</div>
            <div class="confirm-buttons">
                <button class="confirm-btn cancel" id="confirm-cancel">
                    <span>‚úï</span>
                    <span>‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</span>
                </button>
                <button class="confirm-btn confirm" id="confirm-confirm">
                    <span>‚úì</span>
                    <span>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</span>
                </button>
            </div>
        </div>
    </div>

    <div id="loading" class="loading">
        <div class="spinner"></div>
        ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Blynk...
    </div>

    <div id="app" class="container" style="display: none;">
        <div class="header">
            <div class="header-title">
                <span>üå±</span>
                <span>BABY PHUM MACHINE</span>
            </div>
            <div class="header-status">
                <div class="status-dot"></div>
                <span>Online &bull; <span id="current-time"></span></span>
            </div>
        </div>

        <div id="alert-container"></div>
        
        <div class="card">
            <div class="card-header">
                <span>üå±</span>
                <span>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏π‡∏Å</span>
            </div>
            
            <div class="grow-buttons">
                <button class="grow-btn" id="grow-btn-1" onclick="toggleGrowing(1)">
                    <div>üå± ‡∏Å‡∏£‡∏∞‡∏ö‡∏∞ 1</div>
                    <div class="grow-status" id="grow-status-1">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏•‡∏π‡∏Å</div>
                </button>
                <button class="grow-btn" id="grow-btn-2" onclick="toggleGrowing(2)">
                    <div>üå± ‡∏Å‡∏£‡∏∞‡∏ö‡∏∞ 2</div>
                    <div class="grow-status" id="grow-status-2">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏•‡∏π‡∏Å</div>
                </button>
                <button class="grow-btn" id="grow-btn-3" onclick="toggleGrowing(3)">
                    <div>üå± ‡∏Å‡∏£‡∏∞‡∏ö‡∏∞ 3</div>
                    <div class="grow-status" id="grow-status-3">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏•‡∏π‡∏Å</div>
                </button>
            </div>
        </div>
        
        <div class="timer-card">
            <div class="card-header">
                <span>‚è±Ô∏è</span>
                <span>‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏π‡∏Å</span>
            </div>
            <div class="timer-grid">
                <div class="timer-item inactive" id="timer-item-1">
                    <div class="timer-label">‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà 1</div>
                    <div class="timer-value" id="timer-value-1">00:00:00</div>
                    <div class="timer-unit">‡∏ß‡∏±‡∏ô:‡∏ä‡∏°.:‡∏ô‡∏≤‡∏ó‡∏µ</div>
                    <div class="timer-status" id="timer-status-1">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°</div>
                </div>
                <div class="timer-item inactive" id="timer-item-2">
                    <div class="timer-label">‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà 2</div>
                    <div class="timer-value" id="timer-value-2">00:00:00</div>
                    <div class="timer-unit">‡∏ß‡∏±‡∏ô:‡∏ä‡∏°.:‡∏ô‡∏≤‡∏ó‡∏µ</div>
                    <div class="timer-status" id="timer-status-2">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°</div>
                </div>
                <div class="timer-item inactive" id="timer-item-3">
                    <div class="timer-label">‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà 3</div>
                    <div class="timer-value" id="timer-value-3">00:00:00</div>
                    <div class="timer-unit">‡∏ß‡∏±‡∏ô:‡∏ä‡∏°.:‡∏ô‡∏≤‡∏ó‡∏µ</div>
                    <div class="timer-status" id="timer-status-3">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°</div>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <span>üå°Ô∏è</span>
                <span>‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏ô‡πâ‡∏≥</span>
            </div>
            <div class="temp-grid">
                <div class="temp-item">
                    <div class="temp-label">‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà 1</div>
                    <div class="temp-value" id="temp1">--</div>
                    <div class="temp-unit">&deg;C</div>
                </div>
                <div class="temp-item">
                    <div class="temp-label">‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà 2</div>
                    <div class="temp-value" id="temp2">--</div>
                    <div class="temp-unit">&deg;C</div>
                </div>
                <div class="temp-item">
                    <div class="temp-label">‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà 3</div>
                    <div class="temp-value" id="temp3">--</div>
                    <div class="temp-unit">&deg;C</div>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <span>üíß</span>
                <span>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥</span>
            </div>
            <div class="led-item">
                <div class="led-left">
                    <div class="led-circle" id="water1-led"></div>
                    <div class="led-info">
                        <div class="led-label">‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà 1</div>
                    </div>
                </div>
                <div class="led-status" id="water1-status">‡∏ô‡πâ‡∏≥‡πÄ‡∏ï‡πá‡∏°</div>
            </div>
            <div class="led-item">
                <div class="led-left">
                    <div class="led-circle" id="water2-led"></div>
                    <div class="led-info">
                        <div class="led-label">‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà 2</div>
                    </div>
                </div>
                <div class="led-status" id="water2-status">‡∏ô‡πâ‡∏≥‡πÄ‡∏ï‡πá‡∏°</div>
            </div>
            <div class="led-item">
                <div class="led-left">
                    <div class="led-circle" id="water3-led"></div>
                    <div class="led-info">
                        <div class="led-label">‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà 3</div>
                    </div>
                </div>
                <div class="led-status" id="water3-status">‡∏ô‡πâ‡∏≥‡πÄ‡∏ï‡πá‡∏°</div>
            </div>
            <div class="led-item">
                <div class="led-left">
                    <div class="led-circle" id="water4-led"></div>
                    <div class="led-info">
                        <div class="led-label">ü™£ ‡∏ñ‡∏±‡∏á‡∏û‡∏±‡∏Å‡∏ô‡πâ‡∏≥</div>
                    </div>
                </div>
                <div class="led-status" id="water4-status">‡∏ô‡πâ‡∏≥‡πÄ‡∏ï‡πá‡∏°</div>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <span>üö∞</span>
                <span>‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß</span>
            </div>

            <div class="switch-item pump">
                <div class="switch-left">
                    <div class="switch-icon">üíß</div>
                    <div class="switch-info">
                        <div class="switch-label">‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà 1</div>
                    </div>
                </div>
                <div class="toggle pump" id="pump1-toggle" onclick="togglePump(1)">
                    <div class="toggle-thumb"></div>
                </div>
            </div>

            <div class="switch-item pump">
                <div class="switch-left">
                    <div class="switch-icon">üíß</div>
                    <div class="switch-info">
                        <div class="switch-label">‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà 2</div>
                    </div>
                </div>
                <div class="toggle pump" id="pump2-toggle" onclick="togglePump(2)">
                    <div class="toggle-thumb"></div>
                </div>
            </div>

            <div class="switch-item pump">
                <div class="switch-left">
                    <div class="switch-icon">üíß</div>
                    <div class="switch-info">
                        <div class="switch-label">‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà 3</div>
                    </div>
                </div>
                <div class="toggle pump" id="pump3-toggle" onclick="togglePump(3)">
                    <div class="toggle-thumb"></div>
                </div>
            </div>

            <div class="info-box">
                <div class="info-icon">‚ö†Ô∏è</div>
                <div class="info-text">‡∏Ç‡∏ì‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡πÑ‡∏Ç‡πà‡∏ú‡∏≥‡∏Ñ‡∏ß‡∏£‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ï‡∏•‡∏≠‡∏î‡πÄ‡∏ß‡∏•‡∏≤</div>
            </div>
        </div>
    </div>

    <script>const BLYNK_SERVER = 'https://blynk.cloud';
        const BLYNK_AUTH = 'nTrLz6j8b6HiFBJqOjpWOojef9uDSArt';
        
        let emergencyStop = false;
        let harvestHistory = [];
        let fertilizerHistory = [];
        let demoMode = false;
        let waterStatus = { 1: false, 2: false, 3: false, 4: false };
        let growingStatus = { 
            1: { active: false, startTime: null, minutes: 0, harvestTime: null },
            2: { active: false, startTime: null, minutes: 0, harvestTime: null },
            3: { active: false, startTime: null, minutes: 0, harvestTime: null }
        };
let notifications = {
    harvest: [],           // ‡πÄ‡∏Å‡πá‡∏ö pondNum ‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß
    fertilizer: [],        // ‡πÄ‡∏Å‡πá‡∏ö { pondNum, time }
    harvestNotified: {},   // ‡πÄ‡∏Å‡πá‡∏ö { pondNum: startTime } ‡∏ß‡πà‡∏≤‡πÅ‡∏à‡πâ‡∏á‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß
    fertilizerNotified: {} // ‡πÄ‡∏Å‡πá‡∏ö { pondNum: startTime } ‡∏ß‡πà‡∏≤‡πÅ‡∏à‡πâ‡∏á‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß
};
        let darkMode = false;
		let currentTemperatures = {
		1: null,
		2: null,
		3: null
		};
let temperatureWarnings = {
1: { shown: false, lastTemp: null, lastNotifyTime: 0 },
2: { shown: false, lastTemp: null, lastNotifyTime: 0 },
3: { shown: false, lastTemp: null, lastNotifyTime: 0 }
};
        // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
let notificationSettings = {
    sound: false,
    harvest: true,
    fertilizer: true,
    webNotification: false,
    temperature: true  // ‚Üê ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏µ‡πâ
};

        // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤
let timeSettings = {
    harvestDays: 7,
    harvestTime: '12:00',
    fertilizerDays: 7,
    fertilizerTime: '14:00'
};
        // ‡∏£‡∏∞‡∏ö‡∏ö Web Notification
        let notificationPermission = 'default';

        // ‡∏Ç‡∏≠‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Web Notification
        async function requestNotificationPermission() {
            if (!('Notification' in window)) {
                console.log('‚ùå ‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Web Notification');
                return false;
            }
            
            if (Notification.permission === 'granted') {
                notificationPermission = 'granted';
                return true;
            }
            
            if (Notification.permission !== 'denied') {
                const permission = await Notification.requestPermission();
                notificationPermission = permission;
                return permission === 'granted';
            }
            
            return false;
        }

        // ‡∏™‡πà‡∏á Web Notification
// ‡∏™‡πà‡∏á Web Notification (‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÉ‡∏´‡∏°‡πà)
function sendWebNotification(title, message, icon = 'üå±') {
    // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
    if (!notificationSettings.webNotification) {
        console.log('üîï Web Notification ‡∏ñ‡∏π‡∏Å‡∏õ‡∏¥‡∏î');
        return;
    }
    
    // ‡πÄ‡∏ä‡πá‡∏Ñ permission
    if (notificationPermission !== 'granted') {
        console.log('‚ùå ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Web Notification');
        return;
    }
    
    // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
    if (!('Notification' in window)) {
        console.log('‚ùå ‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Web Notification');
        return;
    }
    
    try {
        const notification = new Notification(title, {
            body: message,
            icon: `data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>${icon}</text></svg>`,
            badge: `data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üå±</text></svg>`,
            tag: `baby-phum-${Date.now()}`, // ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô
            requireInteraction: true, // ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏î‡∏õ‡∏¥‡∏î‡πÄ‡∏≠‡∏á
            vibrate: [200, 100, 200], // ‡∏™‡∏±‡πà‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á (‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠)
            silent: false, // ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á
        });
        
        notification.onclick = function() {
            window.focus();
            notification.close();
        };
        
        console.log('‚úÖ ‡∏™‡πà‡∏á Web Notification ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:', title);
    } catch (error) {
        console.error('‚ùå ‡∏™‡πà‡∏á Web Notification ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:', error);
    }
}

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡πÇ‡∏´‡∏°‡∏î‡∏°‡∏∑‡∏î
        function toggleDarkMode() {
            darkMode = !darkMode;
            const body = document.body;
            const toggle = document.getElementById('darkmode-toggle');
            const thumb = toggle.querySelector('.toggle-thumb');
            
            if (darkMode) {
                body.classList.add('dark-mode');
                toggle.classList.add('active');
                thumb.textContent = '‚òÄÔ∏è';
                localStorage.setItem('darkMode', 'enabled');
                console.log('üåô ‡πÇ‡∏´‡∏°‡∏î‡∏°‡∏∑‡∏î: ‡πÄ‡∏õ‡∏¥‡∏î');
            } else {
                body.classList.remove('dark-mode');
                toggle.classList.remove('active');
                thumb.textContent = 'üåô';
                localStorage.setItem('darkMode', 'disabled');
                console.log('‚òÄÔ∏è ‡πÇ‡∏´‡∏°‡∏î‡∏™‡∏ß‡πà‡∏≤‡∏á: ‡πÄ‡∏õ‡∏¥‡∏î');
            }
        }
// ‚úÖ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Sync Toggle ‡∏Å‡∏±‡∏ö LED ‡∏à‡∏£‡∏¥‡∏á
function syncToggleWithLED() {
    // üí° ‡πÑ‡∏ü
    const lightLed = document.getElementById('light-led-menu');
    const lightToggle = document.getElementById('light-toggle-menu');
    
    if (lightLed && lightToggle) {
        const isLightOn = !lightLed.classList.contains('off');
        
        if (isLightOn) {
            lightToggle.classList.add('active');
        } else {
            lightToggle.classList.remove('active');
        }
    }
    
    // üí® ‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô
    const oxygenLed = document.getElementById('oxygen-led-menu');
    const oxygenToggle = document.getElementById('oxygen-toggle-menu');
    
    if (oxygenLed && oxygenToggle) {
        const isOxygenOn = !oxygenLed.classList.contains('off');
        
        if (isOxygenOn) {
            oxygenToggle.classList.add('active');
        } else {
            oxygenToggle.classList.remove('active');
        }
    }
}
        // ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÇ‡∏´‡∏°‡∏î‡∏°‡∏∑‡∏î
        function loadDarkMode() {
            const savedMode = localStorage.getItem('darkMode');
            if (savedMode === 'enabled') {
                darkMode = true;
                document.body.classList.add('dark-mode');
                const toggle = document.getElementById('darkmode-toggle');
                if (toggle) {
                    toggle.classList.add('active');
                    const thumb = toggle.querySelector('.toggle-thumb');
                    if (thumb) thumb.textContent = '‚òÄÔ∏è';
                }
            }
        }

        // ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
function loadNotificationSettings() {
    const saved = localStorage.getItem('notificationSettings');
    if (saved) {
        notificationSettings = JSON.parse(saved);
        
        const soundToggle = document.getElementById('sound-toggle');
        const harvestToggle = document.getElementById('harvest-notif-toggle');
        const fertilizerToggle = document.getElementById('fertilizer-notif-toggle');
        const webNotifToggle = document.getElementById('web-notif-toggle');
        const temperatureToggle = document.getElementById('temperature-notif-toggle'); // ‚Üê ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏µ‡πâ
        
        if (soundToggle) {
            soundToggle.classList.toggle('active', notificationSettings.sound);
        }
        if (harvestToggle) {
            harvestToggle.classList.toggle('active', notificationSettings.harvest);
        }
        if (fertilizerToggle) {
            fertilizerToggle.classList.toggle('active', notificationSettings.fertilizer);
        }
        if (webNotifToggle) {
            webNotifToggle.classList.toggle('active', notificationSettings.webNotification);
        }
        if (temperatureToggle) { // ‚Üê ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏µ‡πâ
            temperatureToggle.classList.toggle('active', notificationSettings.temperature !== false);
        }
    }
    
    // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ default ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ
    if (notificationSettings.temperature === undefined) {
        notificationSettings.temperature = true;
    }
    
    if ('Notification' in window) {
        notificationPermission = Notification.permission;
    }
}



        // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
        function saveNotificationSettings() {
            localStorage.setItem('notificationSettings', JSON.stringify(notificationSettings));
        }

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á


// ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏´‡∏°‡πà)

function saveTimeSettings() {
    // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ñ‡πà‡∏≤
    const dataToSave = {
        harvestDays: timeSettings.harvestDays,
        harvestTime: timeSettings.harvestTime,
        fertilizerDays: timeSettings.fertilizerDays,
        fertilizerTime: timeSettings.fertilizerTime
    };
    
    localStorage.setItem('timeSettings', JSON.stringify(dataToSave));
    console.log('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤:', dataToSave);
    
    // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
    updateExampleText();
}
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• timeSettings ‡πÄ‡∏Å‡πà‡∏≤ (‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß)
function resetTimeSettingsOnce() {
    const key = 'timeSettingsFixed_v2'; // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠ key ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï
    
    if (!localStorage.getItem(key)) {
        console.log('üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß...');
        
        // ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤
        localStorage.removeItem('timeSettings');
        
        // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏´‡∏°‡πà
        timeSettings = {
            harvestDays: 7,
            harvestTime: '12:00',
            fertilizerDays: 7,
            fertilizerTime: '14:00'
        };
        
        saveTimeSettings();
        
        // ‡∏ó‡∏≥‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏ß‡πà‡∏≤‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÅ‡∏•‡πâ‡∏ß
        localStorage.setItem(key, 'true');
        console.log('‚úÖ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô');
    }
}
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á (‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢)
// ‡∏´‡∏≤‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ (‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 480-520)
function updateExampleText() {
    const harvestDays = document.getElementById('harvest-days');
    const harvestTime = document.getElementById('harvest-time');
    const fertilizerDays = document.getElementById('fertilizer-days');
    const fertilizerTime = document.getElementById('fertilizer-time');
    
    const harvestExampleText = document.getElementById('harvest-example-text');
    const fertilizerExampleText = document.getElementById('fertilizer-example-text');
    
    // ‚≠ê ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ elements ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á
    if (!harvestDays || !harvestTime || 
        !fertilizerDays || !fertilizerTime ||
        !harvestExampleText || !fertilizerExampleText) {
        console.log('‚è≥ ‡∏£‡∏≠ elements ‡πÇ‡∏´‡∏•‡∏î...');
        return; // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏° ‡πÉ‡∏´‡πâ‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
    }
    
    // ‚úÖ ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
    harvestExampleText.textContent = 
        `${harvestDays.value} ‡∏ß‡∏±‡∏ô ‡πÄ‡∏ß‡∏•‡∏≤ ${harvestTime.value} ‡∏ô.`;
    
    fertilizerExampleText.textContent = 
        `${fertilizerDays.value} ‡∏ß‡∏±‡∏ô ‡πÄ‡∏ß‡∏•‡∏≤ ${fertilizerTime.value} ‡∏ô.`;
    
    console.log('üìù ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:', {
        harvest: `${harvestDays.value} ‡∏ß‡∏±‡∏ô ${harvestTime.value}`,
        fertilizer: `${fertilizerDays.value} ‡∏ß‡∏±‡∏ô ${fertilizerTime.value}`
    });
}
function toggleTemperatureNotif() {
    notificationSettings.temperature = !notificationSettings.temperature;
    const toggle = document.getElementById('temperature-notif-toggle');
    toggle.classList.toggle('active');
    saveNotificationSettings();
    console.log('üå°Ô∏è ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥:', notificationSettings.temperature ? '‡πÄ‡∏õ‡∏¥‡∏î' : '‡∏õ‡∏¥‡∏î');
}
// ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤
// ‡∏´‡∏≤‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ (‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 560-610)
function loadTimeSettings() {
    const saved = localStorage.getItem('timeSettings');
    
    if (saved) {
        try {
            const savedData = JSON.parse(saved);
            
            timeSettings.harvestDays = savedData.harvestDays !== undefined ? savedData.harvestDays : 7;
            timeSettings.harvestTime = savedData.harvestTime || '12:00';
            timeSettings.fertilizerDays = savedData.fertilizerDays !== undefined ? savedData.fertilizerDays : 7;
            timeSettings.fertilizerTime = savedData.fertilizerTime || '14:00';
            
            console.log('‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:', timeSettings);
        } catch (error) {
            console.error('‚ùå ‡πÇ‡∏´‡∏•‡∏î timeSettings ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:', error);
            timeSettings = {
                harvestDays: 7,
                harvestTime: '12:00',
                fertilizerDays: 7,
                fertilizerTime: '14:00'
            };
        }
    } else {
        console.log('‚ÑπÔ∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• timeSettings ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤ default');
    }
    
    // ‚≠ê ‡πÄ‡∏û‡∏¥‡πà‡∏° setTimeout ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤ DOM ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à
    setTimeout(() => {
        const harvestDaysInput = document.getElementById('harvest-days');
        const harvestTimeInput = document.getElementById('harvest-time');
        const fertilizerDaysInput = document.getElementById('fertilizer-days');
        const fertilizerTimeInput = document.getElementById('fertilizer-time');
        
        if (harvestDaysInput) {
            harvestDaysInput.value = timeSettings.harvestDays;
            console.log('üìÖ ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß:', harvestDaysInput.value);
        }
        
        if (harvestTimeInput) {
            harvestTimeInput.value = timeSettings.harvestTime;
            console.log('üïê ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß:', harvestTimeInput.value);
        }
        
        if (fertilizerDaysInput) {
            fertilizerDaysInput.value = timeSettings.fertilizerDays;
            console.log('üìÖ ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏ô‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢:', fertilizerDaysInput.value);
        }
        
        if (fertilizerTimeInput) {
            fertilizerTimeInput.value = timeSettings.fertilizerTime;
            console.log('üïê ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢:', fertilizerTimeInput.value);
        }
        
        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
        updateExampleText();
    }, 200); // ‡∏£‡∏≠ 200ms ‡πÉ‡∏´‡πâ DOM ‡∏û‡∏£‡πâ‡∏≠‡∏°
}

// ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤
async function confirmTimeSettings() {
    const harvestDays = parseInt(document.getElementById('harvest-days').value);
    const harvestHours = parseInt(document.getElementById('harvest-hours').value);
    const harvestMinutes = parseInt(document.getElementById('harvest-minutes').value);
    const fertilizerDays = parseInt(document.getElementById('fertilizer-days').value);
    const fertilizerHours = parseInt(document.getElementById('fertilizer-hours').value);
    const fertilizerMinutes = parseInt(document.getElementById('fertilizer-minutes').value);
    
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
    if (isNaN(harvestDays) || harvestDays < 0 || harvestDays > 30) {
        alert('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 0-30 ‡∏ß‡∏±‡∏ô');
        return;
    }
    
    if (isNaN(harvestHours) || harvestHours < 0 || harvestHours > 23) {
        alert('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 0-23 ‡∏ä‡∏°.');
        return;
    }
    
    if (isNaN(harvestMinutes) || harvestMinutes < 0 || harvestMinutes > 59) {
        alert('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ô‡∏≤‡∏ó‡∏µ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 0-59 ‡∏ô‡∏≤‡∏ó‡∏µ');
        return;
    }
    
    if (isNaN(fertilizerDays) || fertilizerDays < 0 || fertilizerDays > 30) {
        alert('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 0-30 ‡∏ß‡∏±‡∏ô');
        return;
    }
    
    if (isNaN(fertilizerHours) || fertilizerHours < 0 || fertilizerHours > 23) {
        alert('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 0-23 ‡∏ä‡∏°.');
        return;
    }
    
    if (isNaN(fertilizerMinutes) || fertilizerMinutes < 0 || fertilizerMinutes > 59) {
        alert('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ô‡∏≤‡∏ó‡∏µ‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 0-59 ‡∏ô‡∏≤‡∏ó‡∏µ');
        return;
    }
    
    // ‡πÅ‡∏™‡∏î‡∏á Confirm Dialog
    const confirmed = await showConfirm(
        '‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤',
        `‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?\n\n` +
        `üå± ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß: ${harvestDays} ‡∏ß‡∏±‡∏ô ${harvestHours} ‡∏ä‡∏°. ${harvestMinutes} ‡∏ô‡∏≤‡∏ó‡∏µ\n` +
        `üåæ ‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢: ${fertilizerDays} ‡∏ß‡∏±‡∏ô ${fertilizerHours} ‡∏ä‡∏°. ${fertilizerMinutes} ‡∏ô‡∏≤‡∏ó‡∏µ`,
        { icon: '‚úÖ', type: 'normal' }
    );
    
    if (confirmed) {
        timeSettings.harvestDays = harvestDays;
        timeSettings.harvestHours = harvestHours;
        timeSettings.harvestMinutes = harvestMinutes;
        timeSettings.fertilizerDays = fertilizerDays;
        timeSettings.fertilizerHours = fertilizerHours;
        timeSettings.fertilizerMinutes = fertilizerMinutes;
        
        saveTimeSettings();
        updateExampleText();
        
        console.log('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:', timeSettings);
        
        if (notificationSettings.sound) {
            playNotificationSound();
        }
        
        const container = document.getElementById('alert-container');
        const alertId = `alert-success-${Date.now()}`;
        
        const alertHtml = `
            <div class="alert-banner harvest" id="${alertId}" style="animation: slideIn 0.3s;">
                <div class="alert-icon">‚úÖ</div>
                <div class="alert-content">
                    <div class="alert-title">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</div>
                    <div class="alert-text">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</div>
                </div>
                <button class="alert-close" onclick="document.getElementById('${alertId}').remove()">√ó</button>
            </div>
        `;
        
        container.insertAdjacentHTML('beforeend', alertHtml);
        
        setTimeout(() => {
            const alert = document.getElementById(alertId);
            if (alert) {
                alert.style.animation = 'slideIn 0.3s reverse';
                setTimeout(() => alert.remove(), 300);
            }
        }, 3000);
    }
}

// ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤ (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏´‡∏°‡πà)


        // ‡∏™‡∏•‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
        function toggleSound() {
            notificationSettings.sound = !notificationSettings.sound;
            const toggle = document.getElementById('sound-toggle');
            toggle.classList.toggle('active');
            saveNotificationSettings();
            
            if (notificationSettings.sound) {
                playNotificationSound();
            }
            
            console.log('üîî ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô:', notificationSettings.sound ? '‡πÄ‡∏õ‡∏¥‡∏î' : '‡∏õ‡∏¥‡∏î');
        }

        async function toggleWebNotification() {
            notificationSettings.webNotification = !notificationSettings.webNotification;
            const toggle = document.getElementById('web-notif-toggle');
            
            if (notificationSettings.webNotification) {
                const granted = await requestNotificationPermission();
                
                if (granted) {
                    toggle.classList.add('active');
                    saveNotificationSettings();
                    
                    sendWebNotification(
                        '‚úÖ ‡πÄ‡∏õ‡∏¥‡∏î Web Notification ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                        '‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏°‡πâ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß',
                        '‚úÖ'
                    );
                    console.log('üîî Web Notification: ‡πÄ‡∏õ‡∏¥‡∏î');
                } else {
                    notificationSettings.webNotification = false;
                    toggle.classList.remove('active');
                    alert('‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏¥‡∏î Web Notification ‡πÑ‡∏î‡πâ\n\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå');
                }
            } else {
                toggle.classList.remove('active');
                saveNotificationSettings();
                console.log('üîï Web Notification: ‡∏õ‡∏¥‡∏î');
            }
        }

        function toggleHarvestNotif() {
            notificationSettings.harvest = !notificationSettings.harvest;
            const toggle = document.getElementById('harvest-notif-toggle');
            toggle.classList.toggle('active');
            saveNotificationSettings();
            console.log('üå± ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß:', notificationSettings.harvest ? '‡πÄ‡∏õ‡∏¥‡∏î' : '‡∏õ‡∏¥‡∏î');
        }

        function toggleFertilizerNotif() {
            notificationSettings.fertilizer = !notificationSettings.fertilizer;
            const toggle = document.getElementById('fertilizer-notif-toggle');
            toggle.classList.toggle('active');
            saveNotificationSettings();
            console.log('üåæ ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢:', notificationSettings.fertilizer ? '‡πÄ‡∏õ‡∏¥‡∏î' : '‡∏õ‡∏¥‡∏î');
        }

// ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÅ‡∏ó‡∏ô (‡∏ï‡∏£‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î loadDarkMode())
// ‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏°‡∏î‡πÑ‡∏ü
let lightMode = 'AUTO'; // AUTO, MANUAL_ON, MANUAL_OFF

function toggleLightMode() {
    if (emergencyStop) return;
    
    // ‡∏™‡∏•‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î: AUTO ‚Üí MANUAL_ON ‚Üí MANUAL_OFF ‚Üí AUTO
    if (lightMode === 'AUTO') {
        lightMode = 'MANUAL_ON';
        sendToBlynk('V24', 1);
        console.log('üí° ‡πÑ‡∏ü: MANUAL ON');
    } else if (lightMode === 'MANUAL_ON') {
        lightMode = 'MANUAL_OFF';
        sendToBlynk('V24', 0);
        console.log('üí° ‡πÑ‡∏ü: MANUAL OFF');
    } else {
        lightMode = 'AUTO';
        sendToBlynk('V24', 2); // ‡∏™‡πà‡∏á 2 = AUTO (‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ Arduino ‡∏î‡πâ‡∏ß‡∏¢)
        console.log('üí° ‡πÑ‡∏ü: AUTO');
    }
    
    updateLightModeUI();
}

function updateLightModeUI() {
    const modeBtn = document.getElementById('light-mode-btn');
    const modeDisplay = document.getElementById('light-mode-display');
    
    if (modeBtn && modeDisplay) {
        if (lightMode === 'AUTO') {
            modeBtn.textContent = 'AUTO';
            modeDisplay.textContent = '‡πÇ‡∏´‡∏°‡∏î: AUTO';
            modeBtn.style.background = 'linear-gradient(135deg, #64B5F6 0%, #42A5F5 100%)';
        } else if (lightMode === 'MANUAL_ON') {
            modeBtn.textContent = '‡πÄ‡∏õ‡∏¥‡∏î';
            modeDisplay.textContent = '‡πÇ‡∏´‡∏°‡∏î: ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÄ‡∏õ‡∏¥‡∏î';
            modeBtn.style.background = 'linear-gradient(135deg, #FDD835 0%, #F9A825 100%)';
        } else {
            modeBtn.textContent = '‡∏õ‡∏¥‡∏î';
            modeDisplay.textContent = '‡πÇ‡∏´‡∏°‡∏î: ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏õ‡∏¥‡∏î';
            modeBtn.style.background = 'linear-gradient(135deg, #9E9E9E 0%, #757575 100%)';
        }
    }
}

// ‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏°‡∏î‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô
let oxygenMode = 'AUTO'; // AUTO, MANUAL_ON, MANUAL_OFF

function toggleOxygenMode() {
    if (emergencyStop) return;
    
    // ‡∏™‡∏•‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î: AUTO ‚Üí MANUAL_ON ‚Üí MANUAL_OFF ‚Üí AUTO
    if (oxygenMode === 'AUTO') {
        oxygenMode = 'MANUAL_ON';
        sendToBlynk('V25', 1);
        console.log('üí® ‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô: MANUAL ON');
    } else if (oxygenMode === 'MANUAL_ON') {
        oxygenMode = 'MANUAL_OFF';
        sendToBlynk('V25', 0);
        console.log('üí® ‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô: MANUAL OFF');
    } else {
        oxygenMode = 'AUTO';
        sendToBlynk('V25', 2);
        console.log('üí® ‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô: AUTO');
    }
    
    updateOxygenModeUI();
}

function updateOxygenModeUI() {
    const modeBtn = document.getElementById('oxygen-mode-btn');
    const modeDisplay = document.getElementById('oxygen-mode-display');
    
    if (modeBtn && modeDisplay) {
        if (oxygenMode === 'AUTO') {
            modeBtn.textContent = 'AUTO';
            modeDisplay.textContent = '‡πÇ‡∏´‡∏°‡∏î: AUTO';
            modeBtn.style.background = 'linear-gradient(135deg, #64B5F6 0%, #42A5F5 100%)';
        } else if (oxygenMode === 'MANUAL_ON') {
            modeBtn.textContent = '‡πÄ‡∏õ‡∏¥‡∏î';
            modeDisplay.textContent = '‡πÇ‡∏´‡∏°‡∏î: ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÄ‡∏õ‡∏¥‡∏î';
            modeBtn.style.background = 'linear-gradient(135deg, #4CAF50 0%, #388E3C 100%)';
        } else {
            modeBtn.textContent = '‡∏õ‡∏¥‡∏î';
            modeDisplay.textContent = '‡πÇ‡∏´‡∏°‡∏î: ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏õ‡∏¥‡∏î';
            modeBtn.style.background = 'linear-gradient(135deg, #9E9E9E 0%, #757575 100%)';
        }
    }
}

// ‚úÖ Sync Toggle ‡∏Å‡∏±‡∏ö LED (‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á)
function syncToggleWithLED() {
    // üí° ‡πÑ‡∏ü
    const lightLed = document.getElementById('light-led-menu');
    const lightToggle = document.getElementById('light-status-toggle');
    
    if (lightLed && lightToggle) {
        const isLightOn = !lightLed.classList.contains('off');
        
        if (isLightOn) {
            lightToggle.classList.add('active');
        } else {
            lightToggle.classList.remove('active');
        }
    }
    
    // üí® ‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô
    const oxygenLed = document.getElementById('oxygen-led-menu');
    const oxygenToggle = document.getElementById('oxygen-status-toggle');
    
    if (oxygenLed && oxygenToggle) {
        const isOxygenOn = !oxygenLed.classList.contains('off');
        
        if (isOxygenOn) {
            oxygenToggle.classList.add('active');
        } else {
            oxygenToggle.classList.remove('active');
        }
    }
}
        // ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
        function playNotificationSound() {
            if (notificationSettings.sound) {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 800;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
            }
        }

        // ‡∏™‡∏•‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á Settings Item
        function toggleSettingsItem(element) {
            element.classList.toggle('expanded');
        }

        // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        async function resetAllData() {
            const confirmed = await showConfirm(
                '‚ö†Ô∏è ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î',
                '‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡∏∞‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?\n\n‚Ä¢ ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß\n‚Ä¢ ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢\n‚Ä¢ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏π‡∏Å\n‚Ä¢ ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÜ',
                { icon: '‚ö†Ô∏è', type: 'danger', confirmType: 'danger' }
            );
            
            if (confirmed) {
                localStorage.removeItem('harvestHistory');
                localStorage.removeItem('fertilizerHistory');
                localStorage.removeItem('growingStatus');
                localStorage.removeItem('notificationSettings');
                localStorage.removeItem('darkMode');
                localStorage.removeItem('timeSettings');
                
                console.log('üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                
                alert('‚úÖ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à\n\n‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏£‡∏µ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö');
                location.reload();
            }
        }

        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
        function updateConnectionStatus() {
            const statusEl = document.getElementById('connection-status');
            const modeEl = document.getElementById('mode-status');
            
            if (statusEl) {
                if (demoMode) {
                    statusEl.textContent = 'Demo Mode';
                    statusEl.style.color = '#FFA000';
                } else {
                    statusEl.textContent = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß';
                    statusEl.style.color = '#2E7D32';
                }
            }
            
            if (modeEl) {
                modeEl.textContent = demoMode ? '‡∏ó‡∏î‡∏™‡∏≠‡∏ö' : '‡∏õ‡∏Å‡∏ï‡∏¥';
                modeEl.style.color = demoMode ? '#FFA000' : '#2E7D32';
            }
        }

// Custom Confirm Dialog (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö iOS)
        function showConfirm(title, message, options = {}) {
            return new Promise((resolve) => {
                const overlay = document.getElementById('confirm-overlay');
                const dialog = overlay.querySelector('.confirm-dialog');
                const icon = document.getElementById('confirm-icon');
                const titleEl = document.getElementById('confirm-title');
                const messageEl = document.getElementById('confirm-message');
                const cancelBtn = document.getElementById('confirm-cancel');
                const confirmBtn = document.getElementById('confirm-confirm');
                
                // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤
                icon.textContent = options.icon || '‚ùì';
                icon.className = 'confirm-icon';
                if (options.type === 'warning') icon.classList.add('warning');
                if (options.type === 'danger') icon.classList.add('danger');
                
                titleEl.textContent = title;
                messageEl.textContent = message;
                
                confirmBtn.className = 'confirm-btn confirm';
                if (options.confirmType === 'danger') {
                    confirmBtn.classList.remove('confirm');
                    confirmBtn.classList.add('danger');
                }
                
                // ‚úÖ ‡πÅ‡∏™‡∏î‡∏á overlay ‡πÅ‡∏•‡∏∞ dialog ‡πÅ‡∏¢‡∏Å‡∏Å‡∏±‡∏ô
                overlay.style.display = 'flex';
                
                // ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ browser render ‡∏Å‡πà‡∏≠‡∏ô
                overlay.offsetHeight;
                
                // ‚úÖ ‡πÉ‡∏ä‡πâ requestAnimationFrame ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤ render ‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß
                requestAnimationFrame(() => {
                    overlay.classList.add('show');
                    
                    // ‡πÄ‡∏û‡∏¥‡πà‡∏° animation ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö dialog
                    dialog.style.animation = 'popIn 0.3s forwards';
                });
                
                const handleConfirm = () => {
                    overlay.classList.remove('show');
                    setTimeout(() => {
                        overlay.style.display = 'none';
                        cleanup();
                        resolve(true);
                    }, 300);
                };
                
                const handleCancel = () => {
                    overlay.classList.remove('show');
                    setTimeout(() => {
                        overlay.style.display = 'none';
                        cleanup();
                        resolve(false);
                    }, 300);
                };
                
                const cleanup = () => {
                    dialog.style.animation = '';
                    confirmBtn.removeEventListener('click', handleConfirm);
                    cancelBtn.removeEventListener('click', handleCancel);
                    overlay.removeEventListener('click', handleOverlayClick);
                };
                
                const handleOverlayClick = (e) => {
                    if (e.target === overlay) handleCancel();
                };
                
                confirmBtn.addEventListener('click', handleConfirm);
                cancelBtn.addEventListener('click', handleCancel);
                overlay.addEventListener('click', handleOverlayClick);
            });
        }

        // ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
        function showAlert(type, pondNum, message) {
            if (type === 'harvest' && !notificationSettings.harvest) return;
            if (type === 'fertilizer' && !notificationSettings.fertilizer) return;
            
            const container = document.getElementById('alert-container');
            const alertId = `alert-${type}-${pondNum}-${Date.now()}`;
            
            const alertHtml = `
                <div class="alert-banner ${type}" id="${alertId}">
                    <div class="alert-icon">${type === 'harvest' ? 'üå±' : 'üåæ'}</div>
                    <div class="alert-content">
                        <div class="alert-title">${type === 'harvest' ? '‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß!' : '‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢!'}</div>
                        <div class="alert-text">${message}</div>
                    </div>
                    <button class="alert-close" onclick="closeAlert('${alertId}', '${type}', ${pondNum})">√ó</button>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', alertHtml);
            
            playNotificationSound();
            
            const title = type === 'harvest' ? 'üå± ‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß!' : 'üåæ ‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢!';
            const icon = type === 'harvest' ? 'üå±' : 'üåæ';
            sendWebNotification(title, message, icon);
            
            if (type === 'fertilizer') {
                notifications.fertilizer.push({ pondNum, time: Date.now() });
                updateFertilizerBadge();
            }
        }
// ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô closeAlert() ‡πÄ‡∏î‡∏¥‡∏°‡∏î‡πâ‡∏ß‡∏¢‡πÇ‡∏Ñ‡πâ‡∏î‡∏ô‡∏µ‡πâ
function closeAlert(alertId, type, pondNum) {
    const alert = document.getElementById(alertId);
    if (alert) {
        alert.style.animation = 'slideIn 0.3s reverse';
        setTimeout(() => alert.remove(), 300);
    }
    
    if (type === 'fertilizer') {
        addFertilizerRecord(pondNum);
        notifications.fertilizer = notifications.fertilizer.filter(n => n.pondNum !== pondNum);
        saveNotificationState();
        updateFertilizerBadge();
        console.log(`‚úÖ ‡∏õ‡∏¥‡∏î‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢‡∏Å‡∏£‡∏∞‡∏ö‡∏∞ ${pondNum}`);
    }
    
    if (type === 'harvest') {
        notifications.harvest = notifications.harvest.filter(n => n !== pondNum);
        saveNotificationState();
        console.log(`‚úÖ ‡∏õ‡∏¥‡∏î‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏£‡∏∞‡∏ö‡∏∞ ${pondNum}`);
    }
}
        function updateFertilizerBadge() {
            const badge = document.getElementById('fertilizer-badge');
            const count = notifications.fertilizer.length;
            if (count > 0) {
                badge.textContent = count;
                badge.style.display = 'flex';
            } else {
                badge.style.display = 'none';
            }
        }

function checkNotifications() {
    const now = Date.now();
    const CHECK_INTERVAL = 60000; // 1 ‡∏ô‡∏≤‡∏ó‡∏µ
    
    for (let i = 1; i <= 3; i++) {
        const status = growingStatus[i];
        
        if (!status.active || !status.startTime) continue;
        
        const startDate = new Date(status.startTime);
        
        // ===============================
        // üå± ‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß
        // ===============================
        const harvestDate = new Date(startDate);
        harvestDate.setDate(harvestDate.getDate() + timeSettings.harvestDays);
        
        const [harvestHours, harvestMinutes] = timeSettings.harvestTime.split(':').map(Number);
        harvestDate.setHours(harvestHours, harvestMinutes, 0, 0);
        
        const harvestTime = harvestDate.getTime();
        const lastNotifyTime = notifications.harvestNotified[i] || 0;
        const timeSinceLastNotify = now - lastNotifyTime;
        const shouldNotifyHarvest = now >= harvestTime && timeSinceLastNotify >= CHECK_INTERVAL;
        
        if (shouldNotifyHarvest) {
            const elapsed = now - status.startTime;
            const days = Math.floor(elapsed / (24 * 60 * 60 * 1000));
            const hours = Math.floor((elapsed % (24 * 60 * 60 * 1000)) / (60 * 60 * 1000));
            const minutes = Math.floor((elapsed % (60 * 60 * 1000)) / (60 * 1000));
            
            console.log(`üîî [‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß] ‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà ${i} ‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤!`);
            
            showAlert('harvest', i, 
                `‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà ${i} ‡∏õ‡∏•‡∏π‡∏Å‡∏°‡∏≤ ${days} ‡∏ß‡∏±‡∏ô ${hours}:${String(minutes).padStart(2, '0')} ‡∏ô. ‡πÅ‡∏•‡πâ‡∏ß\n` +
                `(‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ ${timeSettings.harvestDays} ‡∏ß‡∏±‡∏ô ‡πÄ‡∏ß‡∏•‡∏≤ ${timeSettings.harvestTime} ‡∏ô.)`
            );
            
            if (!notifications.harvest.includes(i)) {
                notifications.harvest.push(i);
            }
            notifications.harvestNotified[i] = now;
            saveNotificationState();
        }
        
        // ===============================
        // üåæ ‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢
        // ===============================
        const fertilizerDate = new Date(startDate);
        fertilizerDate.setDate(fertilizerDate.getDate() + timeSettings.fertilizerDays);
        
        const [fertilizerHours, fertilizerMinutes] = timeSettings.fertilizerTime.split(':').map(Number);
        fertilizerDate.setHours(fertilizerHours, fertilizerMinutes, 0, 0);
        
        const fertilizerTime = fertilizerDate.getTime();
        const lastFertilizerNotify = notifications.fertilizerNotified[i] || 0;
        const timeSinceFertilizer = now - lastFertilizerNotify;
        const shouldNotifyFertilizer = now >= fertilizerTime && timeSinceFertilizer >= CHECK_INTERVAL;
        
        if (shouldNotifyFertilizer) {
            const elapsed = now - status.startTime;
            const days = Math.floor(elapsed / (24 * 60 * 60 * 1000));
            const hours = Math.floor((elapsed % (24 * 60 * 60 * 1000)) / (60 * 60 * 1000));
            const minutes = Math.floor((elapsed % (60 * 60 * 1000)) / (60 * 1000));
            
            console.log(`üîî [‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢] ‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà ${i} ‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤!`);
            
            showAlert('fertilizer', i, 
                `‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà ${i} ‡∏õ‡∏•‡∏π‡∏Å‡∏°‡∏≤ ${days} ‡∏ß‡∏±‡∏ô ${hours}:${String(minutes).padStart(2, '0')} ‡∏ô. ‡πÅ‡∏•‡πâ‡∏ß\n` +
                `(‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ ${timeSettings.fertilizerDays} ‡∏ß‡∏±‡∏ô ‡πÄ‡∏ß‡∏•‡∏≤ ${timeSettings.fertilizerTime} ‡∏ô.)`
            );
            
            const alreadyInList = notifications.fertilizer.some(f => f.pondNum === i);
            if (!alreadyInList) {
                notifications.fertilizer.push({ pondNum: i, time: now });
            }
            notifications.fertilizerNotified[i] = now;
            saveNotificationState();
            updateFertilizerBadge();
        }
    }
}
function testNotification() {
    console.log('üîî ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô');
    playNotificationSound();
    sendWebNotification('üå± ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô', '‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥', '‚úÖ');
    showAlert('harvest', 1, '‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß');
}
// ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å/‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
function saveNotificationState() {
    localStorage.setItem('notificationState', JSON.stringify(notifications));
    console.log('üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô:', {
        harvest: notifications.harvest,
        fertilizer: notifications.fertilizer.map(f => f.pondNum),
        harvestNotified: notifications.harvestNotified,
        fertilizerNotified: notifications.fertilizerNotified
    });
}
function loadNotificationState() {
    const saved = localStorage.getItem('notificationState');
    if (saved) {
        const data = JSON.parse(saved);
        notifications = {
            harvest: data.harvest || [],
            fertilizer: data.fertilizer || [],
            harvestNotified: data.harvestNotified || {},
            fertilizerNotified: data.fertilizerNotified || {}
        };
        updateFertilizerBadge();
        console.log('üìÇ ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô:', notifications);
    }
}
// ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å/‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥
function saveTemperatureWarnings() {
    localStorage.setItem('temperatureWarnings', JSON.stringify(temperatureWarnings));
    console.log('üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥:', temperatureWarnings);
}

function loadTemperatureWarnings() {
    const saved = localStorage.getItem('temperatureWarnings');
    if (saved) {
        temperatureWarnings = JSON.parse(saved);
        console.log('üìÇ ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥:', temperatureWarnings);
    }
}
		// ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
        function addFertilizerRecord(pondNum) {
            const now = new Date();
            const months = ['‡∏°.‡∏Ñ.', '‡∏Å.‡∏û.', '‡∏°‡∏µ.‡∏Ñ.', '‡πÄ‡∏°.‡∏¢.', '‡∏û.‡∏Ñ.', '‡∏°‡∏¥.‡∏¢.', '‡∏Å.‡∏Ñ.', '‡∏™.‡∏Ñ.', '‡∏Å.‡∏¢.', '‡∏ï.‡∏Ñ.', '‡∏û.‡∏¢.', '‡∏ò.‡∏Ñ.'];
            
            const record = {
                pond: pondNum,
                date: `${now.getDate()} ${months[now.getMonth()]} ${now.getFullYear() + 543}`,
                time: `${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')} ‡∏ô.`,
                timestamp: now.getTime()
            };
            
            fertilizerHistory.unshift(record);
            if (fertilizerHistory.length > 20) fertilizerHistory.pop();
            
            saveFertilizerHistory();
            displayFertilizerHistory();
            

        }

        function displayFertilizerHistory() {
            const fertilizerList = document.getElementById('fertilizer-list');
            
            if (fertilizerHistory.length === 0) {
                fertilizerList.innerHTML = '<div class="no-history">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢</div>';
                return;
            }
            
            fertilizerList.innerHTML = fertilizerHistory.map(record => `
                <div class="fertilizer-item">
                    <div class="fertilizer-pond">üåæ ‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà ${record.pond}</div>
                    <div class="fertilizer-date">üìÖ ${record.date}</div>
                    <div class="fertilizer-time">üïê ${record.time}</div>
                </div>
            `).join('');
        }

        function loadFertilizerHistory() {
            const saved = localStorage.getItem('fertilizerHistory');
            if (saved) {
                fertilizerHistory = JSON.parse(saved);
                displayFertilizerHistory();
            }
        }

        function saveFertilizerHistory() {
            localStorage.setItem('fertilizerHistory', JSON.stringify(fertilizerHistory));
        }

        async function clearFertilizerHistory() {
            const confirmed = await showConfirm(
                'üóëÔ∏è ‡∏•‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢',
                '‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?',
                { icon: 'üóëÔ∏è', type: 'danger', confirmType: 'danger' }
            );
            
            if (confirmed) {
                fertilizerHistory = [];
                saveFertilizerHistory();
                displayFertilizerHistory();
            }
        }

        function loadGrowingData() {
            const saved = localStorage.getItem('growingStatus');
            if (saved) {
                growingStatus = JSON.parse(saved);
                for (let i = 1; i <= 3; i++) {
                    if (growingStatus[i].active) {
                        updateGrowingUI(i, true);
                    }
                }
            }
        }

        function saveGrowingData() {
            localStorage.setItem('growingStatus', JSON.stringify(growingStatus));
        }

        function updateGrowingUI(pondNum, isGrowing) {
            console.log(`üå± Update UI Pond ${pondNum}:`, isGrowing ? 'GROWING' : 'STOPPED');
            
            const btn = document.getElementById(`grow-btn-${pondNum}`);
            const statusText = document.getElementById(`grow-status-${pondNum}`);
            const timerItem = document.getElementById(`timer-item-${pondNum}`);
            const timerStatus = document.getElementById(`timer-status-${pondNum}`);
            
            if (isGrowing) {
                btn.classList.add('growing');
                statusText.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏•‡∏π‡∏Å...';
                timerItem.classList.remove('inactive');
                timerStatus.textContent = 'üå± ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏•‡∏π‡∏Å';
            } else {
                btn.classList.remove('growing');
                statusText.textContent = '‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏•‡∏π‡∏Å';
                timerItem.classList.add('inactive');
                timerStatus.textContent = '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°';
                document.getElementById(`timer-value-${pondNum}`).textContent = '00:00:00';
            }
            
            updatePumpButtonStatus(pondNum, waterStatus[pondNum]);
        }

        function updateGrowingTimers() {
            for (let i = 1; i <= 3; i++) {
                if (growingStatus[i].active && growingStatus[i].startTime) {
                    const elapsed = Date.now() - growingStatus[i].startTime;
                    const totalMinutes = Math.floor(elapsed / (1000 * 60));
                    const days = Math.floor(totalMinutes / (60 * 24));
                    const hours = Math.floor((totalMinutes % (60 * 24)) / 60);
                    const minutes = totalMinutes % 60;
                    
                    growingStatus[i].minutes = totalMinutes;
                    
                    const valueEl = document.getElementById(`timer-value-${i}`);
                    valueEl.textContent = `${String(days).padStart(2, '0')}:${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}`;
                }
            }
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebar-overlay');
            const btn = document.getElementById('hamburger-btn');
            
            sidebar.classList.toggle('open');
            overlay.classList.toggle('show');
            btn.classList.toggle('active');
        }

        function showSection(sectionName) {
            document.querySelectorAll('.sidebar-section').forEach(section => {
                section.classList.remove('active');
            });
            
            document.getElementById(`section-${sectionName}`).classList.add('active');
            
            document.querySelectorAll('.sidebar-menu-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.closest('.sidebar-menu-item').classList.add('active');
        }

        function syncControls(source, isActive, type) {
            if (type === 'light') {
                const menuToggle = document.getElementById('light-toggle-menu');
                const menuMode = document.getElementById('light-mode-menu');
                
                menuToggle.classList.toggle('active', isActive);
                menuMode.textContent = isActive ? 'Manual' : 'Auto';
} else if (type === 'oxygen') {
    const menuToggle = document.getElementById('oxygen-toggle-menu');
    const menuMode = document.getElementById('oxygen-mode-menu');
    
    menuToggle.classList.toggle('active', isActive);
    menuMode.textContent = isActive ? '‡πÄ‡∏õ‡∏¥‡∏î' : '‡∏õ‡∏¥‡∏î';  // ‚Üê ‡πÅ‡∏Å‡πâ‡πÄ‡∏õ‡πá‡∏ô "‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î"
}
		else if (type.startsWith('pump')) {
                const pumpNum = type.replace('pump', '');
                const mainToggle = document.getElementById(`pump${pumpNum}-toggle`);
                const mainMode = document.getElementById(`pump${pumpNum}-mode`);
                
                mainToggle.classList.toggle('active', isActive);
                mainMode.textContent = isActive ? '‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÄ‡∏õ‡∏¥‡∏î' : 'Auto';
            }
        }

        function toggleLightMenu() {
            if (emergencyStop) return;
            
            const toggle = document.getElementById('light-toggle-menu');
            const menuMode = document.getElementById('light-mode-menu');
            
            toggle.classList.toggle('active');
            
            if (toggle.classList.contains('active')) {
                menuMode.textContent = 'Manual';
                sendToBlynk('V24', 1);
            } else {
                menuMode.textContent = 'Auto';
                sendToBlynk('V24', 0);
            }
            
            console.log('üí° ‡πÑ‡∏ü:', toggle.classList.contains('active') ? '‡πÄ‡∏õ‡∏¥‡∏î' : '‡∏õ‡∏¥‡∏î');
        }

        function toggleOxygenMenu() {
            if (emergencyStop) return;
            
            const toggle = document.getElementById('oxygen-toggle-menu');
            const menuMode = document.getElementById('oxygen-mode-menu');
            const isCurrentlyActive = toggle.classList.contains('active');
            
            toggle.classList.toggle('active');
            const newState = !isCurrentlyActive;
            
if (newState) {
    menuMode.textContent = '‡πÄ‡∏õ‡∏¥‡∏î';  // ‚Üê ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô "‡πÄ‡∏õ‡∏¥‡∏î"
    sendToBlynk('V25', 1);
    console.log('üí® ‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô: ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÄ‡∏õ‡∏¥‡∏î');  // ‚Üê ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏´‡∏°‡πà
} else {
    menuMode.textContent = '‡∏õ‡∏¥‡∏î';   // ‚Üê ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô "‡∏õ‡∏¥‡∏î"
    sendToBlynk('V25', 0);
    console.log('üí® ‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô: ‡∏õ‡∏¥‡∏î');  // ‚Üê ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏´‡∏°‡πà
}
        }

const demoData = {
    V2: 1,
    V7: 28.5,
    V6: 29.2,
    V5: 27.8,
    V17: 1,
    V16: 1,
    V15: 0,
    V0: 0,
    V1: 0,
};

        async function clearHistory() {
            const confirmed = await showConfirm(
                'üóëÔ∏è ‡∏•‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß',
                '‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?',
                { icon: 'üóëÔ∏è', type: 'danger', confirmType: 'danger' }
            );
            
            if (confirmed) {
                harvestHistory = [];
                saveHistory();
                displayHistory();
            }
        }

        function loadHistory() {
            const saved = localStorage.getItem('harvestHistory');
            if (saved) {
                harvestHistory = JSON.parse(saved);
                displayHistory();
            }
        }

        function saveHistory() {
            localStorage.setItem('harvestHistory', JSON.stringify(harvestHistory));
        }

        function addHarvestRecord(pondNum) {
            const now = new Date();
            const months = ['‡∏°.‡∏Ñ.', '‡∏Å.‡∏û.', '‡∏°‡∏µ.‡∏Ñ.', '‡πÄ‡∏°.‡∏¢.', '‡∏û.‡∏Ñ.', '‡∏°‡∏¥.‡∏¢.', '‡∏Å.‡∏Ñ.', '‡∏™.‡∏Ñ.', '‡∏Å.‡∏¢.', '‡∏ï.‡∏Ñ.', '‡∏û.‡∏¢.', '‡∏ò.‡∏Ñ.'];
            
            const record = {
                pond: pondNum,
                date: `${now.getDate()} ${months[now.getMonth()]} ${now.getFullYear() + 543}`,
                time: `${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')} ‡∏ô.`,
                timestamp: now.getTime()
            };
            
            harvestHistory.unshift(record);
            if (harvestHistory.length > 20) harvestHistory.pop();
            
            saveHistory();
            displayHistory();
        }

        function displayHistory() {
            const historyList = document.getElementById('history-list');
            
            if (harvestHistory.length === 0) {
                historyList.innerHTML = '<div class="no-history">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö</div>';
                return;
            }
            
            historyList.innerHTML = harvestHistory.map(record => `
                <div class="history-item">
                    <div class="history-pond">üå± ‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà ${record.pond}</div>
                    <div class="history-date">üìÖ ${record.date}</div>
                    <div class="history-time">üïê ${record.time}</div>
                </div>
            `).join('');
        }

        function updateTime() {
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const timeEl = document.getElementById('current-time');
            if (timeEl) {
                timeEl.textContent = `${hours}:${minutes}`;
            }
        }

        async function fetchBlynkData() {
    try {
		const pins = ['V2', 'V7', 'V6', 'V5', 'V17', 'V16', 'V15', 'V24', 'V25', 'V12', 'V11', 'V10', 'V0', 'V1', 'V22', 'V21', 'V20'];        
        // ‡πÄ‡∏û‡∏¥‡πà‡∏° timeout 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), 5000);
        
        const response = await fetch(
            `${BLYNK_SERVER}/external/api/get?token=${BLYNK_AUTH}&${pins.join('&')}`,
            { 
                method: 'GET',
                signal: controller.signal
            }
        );
        
        clearTimeout(timeoutId);
        
        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
        
        const data = await response.json();
        
        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏î‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤‡∏à‡∏£‡∏¥‡∏á
        if (!data || Object.keys(data).length === 0) {
            throw new Error('No data received');
        }
        
        // ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
        if (demoMode) {
            demoMode = false;
            console.log('‚úÖ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Blynk ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
        }
        
        displayData(data);
        
    } catch (error) {
        console.error('‚ùå Error fetching Blynk data:', error.message);
        
        // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡πÄ‡∏Ç‡πâ‡∏≤ demo mode ‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏•‡∏¢
        if (!demoMode) {
            enterDemoMode();
        } else {
            // ‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏π‡πà demo mode ‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏∏‡πà‡∏°
            displayData(demoData);
        }
    }
}
        
		function enterDemoMode() {
    demoMode = true;
    console.log('‚ö†Ô∏è ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡πÇ‡∏´‡∏°‡∏î‡∏ó‡∏î‡∏™‡∏≠‡∏ö (Demo Mode)');
    
    // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
    const loadingEl = document.getElementById('loading');
    if (loadingEl) {
        loadingEl.innerHTML = 
            '<div class="spinner"></div>' +
            '<div style="margin-top: 16px;">‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Blynk ‡πÑ‡∏î‡πâ</div>' +
            '<div style="font-size: 13px; opacity: 0.8; margin-top: 8px;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡πÇ‡∏´‡∏°‡∏î‡∏ó‡∏î‡∏™‡∏≠‡∏ö...</div>';
    }
    
    // ‡∏£‡∏≠ 1.5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
    setTimeout(() => {
        displayData(demoData);
        
        // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏∏‡πà‡∏°‡∏ó‡∏∏‡∏Å 3 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
        setInterval(() => {
            demoData.V2 = Math.random() > 0.5 ? 1 : 0;
			demoData.V7 = (27 + Math.random() * 3).toFixed(1);
			demoData.V6 = (27 + Math.random() * 3).toFixed(1);
			demoData.V5 = (27 + Math.random() * 3).toFixed(1);
			demoData.V17 = Math.random() > 0.5 ? 1 : 0;
			demoData.V16 = Math.random() > 0.5 ? 1 : 0;
			demoData.V15 = Math.random() > 0.5 ? 1 : 0;
            demoData.V0 = Math.random() > 0.5 ? 1 : 0;
            demoData.V1 = Math.random() > 0.5 ? 1 : 0;
            displayData(demoData);
        }, 3000);
    }, 1500);
}

        function syncInitialState(data) {
            const lightManual = data.V24 == 1;
            const lightToggle = document.getElementById('light-toggle-menu');
            const lightMode = document.getElementById('light-mode-menu');
            
            if (lightToggle && lightMode) {
                lightToggle.classList.toggle('active', lightManual);
                lightMode.textContent = lightManual ? 'Manual' : 'Auto';
            }
            
            const oxygenOn = data.V25 == 1;
            const oxygenToggle = document.getElementById('oxygen-toggle-menu');
            const oxygenMode = document.getElementById('oxygen-mode-menu');
            
if (oxygenToggle && oxygenMode) {
    oxygenToggle.classList.toggle('active', oxygenOn);
    oxygenMode.textContent = oxygenOn ? '‡πÄ‡∏õ‡∏¥‡∏î' : '‡∏õ‡∏¥‡∏î';  // ‚Üê ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
}
            
            console.log('‚úÖ Synced initial state:', {
                lightManual,
                oxygenOn,
                growingStatus
            });
        }

function displayData(data) {
    // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÅ‡∏•‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥
    const temp1 = data.V7 !== undefined ? parseFloat(data.V7) : null;
    const temp2 = data.V6 !== undefined ? parseFloat(data.V6) : null;
    const temp3 = data.V5 !== undefined ? parseFloat(data.V5) : null;
    
    currentTemperatures[1] = temp1;
    currentTemperatures[2] = temp2;
    currentTemperatures[3] = temp3;
    
    // ‚≠ê ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡∏∞‡∏™‡∏µ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥
    updateTemperatureDisplay(1, temp1);
    updateTemperatureDisplay(2, temp2);
    updateTemperatureDisplay(3, temp3);
    
    // ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏Ç‡∏≠‡∏á‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°...
    updateWaterStatus(1, data.V15);
    updateWaterStatus(2, data.V16);
    updateWaterStatus(3, data.V17);
    updateWaterStatus(4, data.V2);
    
    updateLEDStatus(data);
    syncInitialState(data);
	
	syncToggleWithLED();


    document.getElementById('loading').style.display = 'none';
    document.getElementById('app').style.display = 'block';
    document.getElementById('sidebar').style.display = 'block';
    
    const statusText = document.querySelector('.header-status span');
    if (statusText && demoMode) {
        statusText.innerHTML = `<span style="color: #FDD835;">‚ö†Ô∏è ‡πÇ‡∏´‡∏°‡∏î‡∏ó‡∏î‡∏™‡∏≠‡∏ö</span> &bull; <span id="current-time"></span>`;
        updateTime();
    }
    updateConnectionStatus();
}
        function updateLEDStatus(data) {
            const lightLed = document.getElementById('light-led-menu');
            if (lightLed) {
                if (data.V0 == 1) {
                    lightLed.classList.remove('off');
                } else {
                    lightLed.classList.add('off');
                }
            }
            
            const oxygenLed = document.getElementById('oxygen-led-menu');
            if (oxygenLed) {
                if (data.V1 == 1) {
                    oxygenLed.classList.remove('off');
                } else {
                    oxygenLed.classList.add('off');
                }
            }
			syncToggleWithLED();

        }

        function updateWaterStatus(pondNum, value) {
            const hasWater = value == 1;
            waterStatus[pondNum] = hasWater;
            
            const led = document.getElementById(`water${pondNum}-led`);
            const status = document.getElementById(`water${pondNum}-status`);
            
            if (hasWater) {
                led.classList.remove('off');
                status.classList.remove('off');
                status.textContent = '‡∏ô‡πâ‡∏≥‡πÄ‡∏ï‡πá‡∏°';
            } else {
                led.classList.add('off');
                status.classList.add('off');
                status.textContent = '‡πÑ‡∏°‡πà‡πÄ‡∏ï‡πá‡∏°';
            }
            
            if (pondNum <= 3) {
                updatePumpButtonStatus(pondNum, hasWater);
            }
        }

        function updatePumpButtonStatus(pondNum, hasWater) {
            const pumpItem = document.getElementById(`pump${pondNum}-toggle`).closest('.switch-item');
            const isGrowing = growingStatus[pondNum] && growingStatus[pondNum].active;
            
            if (hasWater && isGrowing) {
                pumpItem.classList.remove('disabled');
            } else {
                pumpItem.classList.add('disabled');
                const toggle = document.getElementById(`pump${pondNum}-toggle`);
                if (toggle.classList.contains('active')) {
                    toggle.classList.remove('active');
                    const mode = document.getElementById(`pump${pondNum}-mode`);
                    mode.textContent = 'Auto';
                    sendToBlynk(getPumpPin(pondNum), 0);
                }
            }
        }
// ‚≠ê ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ
function updateTemperatureDisplay(pondNum, temp) {
    const tempElement = document.getElementById(`temp${pondNum}`);
    const tempItem = tempElement.closest('.temp-item');
    
    // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ñ‡πà‡∏≤‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥
    if (temp !== null && !isNaN(temp)) {
        tempElement.textContent = temp.toFixed(1);
        
        // ‡∏•‡∏ö class ‡πÄ‡∏Å‡πà‡∏≤‡∏≠‡∏≠‡∏Å‡∏Å‡πà‡∏≠‡∏ô
        tempItem.classList.remove('cold', 'hot');
        
        // ‡πÄ‡∏û‡∏¥‡πà‡∏° class ‡∏ï‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏á‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥
        if (temp < 20) {
            tempItem.classList.add('cold');
            console.log(`‚ùÑÔ∏è ‡∏Å‡∏£‡∏∞‡∏ö‡∏∞ ${pondNum}: ${temp}¬∞C (‡∏ï‡πà‡∏≥)`);
        } else if (temp > 28) {
            tempItem.classList.add('hot');
            console.log(`üî• ‡∏Å‡∏£‡∏∞‡∏ö‡∏∞ ${pondNum}: ${temp}¬∞C (‡∏™‡∏π‡∏á)`);
        } else {
            console.log(`‚úÖ ‡∏Å‡∏£‡∏∞‡∏ö‡∏∞ ${pondNum}: ${temp}¬∞C (‡∏õ‡∏Å‡∏ï‡∏¥)`);
        }
    } else {
        tempElement.textContent = '--';
        tempItem.classList.remove('cold', 'hot');
    }
}
function getPumpPin(pondNum) {
    const pins = { 1: 'V10', 2: 'V11', 3: 'V12' };
    return pins[pondNum];
}

        async function sendToBlynk(pin, value) {
            if (emergencyStop && value === 1) return false;
            if (demoMode) {
                console.log(`[Demo Mode] ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á ${pin} = ${value}`);
                return true;
            }
            
            try {
                const response = await fetch(
                    `${BLYNK_SERVER}/external/api/update?token=${BLYNK_AUTH}&${pin}=${value}`,
                    { method: 'GET' }
                );
                return response.ok;
            } catch (error) {
                console.error('Error sending to Blynk:', error);
                return false;
            }
        }

async function togglePump(pumpNum) {
    if (emergencyStop) return;
    
    const toggle = document.getElementById(`pump${pumpNum}-toggle`);
    const isActive = toggle.classList.contains('active');
    const pumpItem = toggle.closest('.switch-item');
    
    // ‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç: ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏ô‡πâ‡∏≥ + ‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡∏¢‡∏π‡πà
    if (pumpItem.classList.contains('disabled') && !isActive) {
        if (!growingStatus[pumpNum].active) {
            alert(`‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡πÑ‡∏î‡πâ\n\n‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏•‡∏π‡∏Å‡πÉ‡∏ô‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà ${pumpNum} ‡∏Å‡πà‡∏≠‡∏ô`);
        } else if (!waterStatus[pumpNum]) {
            alert(`‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡πÑ‡∏î‡πâ\n\n‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà ${pumpNum} ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ô‡πâ‡∏≥`);
        }
        return;
    }
    
    const pins = { 1: 'V10', 2: 'V11', 3: 'V12' };
    
    if (!isActive) {
        // ‡∏Å‡∏î‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà 1: ‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏±‡πä‡∏°‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏ô‡πâ‡∏≥
        console.log(`üíß Pump ${pumpNum}: ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß - ‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏±‡πä‡∏°‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏ô‡πâ‡∏≥`);
        
        toggle.classList.add('active');
        const mode = document.getElementById(`pump${pumpNum}-mode`);
        if (mode) mode.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Å‡πá‡∏ö...';
        
        await sendToBlynk(pins[pumpNum], 1);
        console.log(`üì§ ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏±‡πä‡∏° ${pumpNum}`);
        
    } else {
        // ‡∏Å‡∏î‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà 2: ‡∏õ‡∏¥‡∏î‡∏õ‡∏±‡πä‡∏° + ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
        console.log(`üíß Pump ${pumpNum}: ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à - ‡∏õ‡∏¥‡∏î‡∏õ‡∏±‡πä‡∏° + ‡∏´‡∏¢‡∏∏‡∏î‡∏õ‡∏•‡∏π‡∏Å`);
        
        const confirmed = await showConfirm(
            '‚úÖ ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
            `‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà ${pumpNum} ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß!\n\n‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏π‡∏Å‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥`,
            { icon: '‚úÖ', type: 'normal' }
        );
        
        if (confirmed) {
            // 1. ‡∏õ‡∏¥‡∏î UI Toggle
            toggle.classList.remove('active');
            const mode = document.getElementById(`pump${pumpNum}-mode`);
            if (mode) mode.textContent = 'Auto';
            
            // 2. ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏õ‡∏¥‡∏î‡∏õ‡∏±‡πä‡∏°
            const pumpSuccess = await sendToBlynk(pins[pumpNum], 0);
            console.log(`üì§ ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏õ‡∏¥‡∏î‡∏õ‡∏±‡πä‡∏° ${pumpNum}:`, pumpSuccess ? '‚úÖ' : '‚ùå');
            
            await new Promise(resolve => setTimeout(resolve, 500));
            
            if (pumpSuccess) {
                // 3. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß
                addHarvestRecord(pumpNum);
                
                // 4. ‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏π‡∏Å
                if (growingStatus[pumpNum].active) {
                    growingStatus[pumpNum].active = false;
                    growingStatus[pumpNum].startTime = null;
                    growingStatus[pumpNum].minutes = 0;
                    
                    updateGrowingUI(pumpNum, false);
                    saveGrowingData();
                    
                    // ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏ã‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå
                    const growPins = { 1: 'V22', 2: 'V21', 3: 'V20' };
                    await sendToBlynk(growPins[pumpNum], 0);
                    console.log(`üõë ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏ã‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà ${pumpNum}`);
                    
                    // ‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
                    notifications.harvest = notifications.harvest.filter(n => n !== pumpNum);
                    saveNotificationState();
                }
                
                // 5. ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡πÉ‡∏î‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß
                const anyPondActive = Object.values(growingStatus).some(s => s.active);
                
                console.log('üîç ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡∏¢‡∏π‡πà:', {
                    pond1: growingStatus[1].active,
                    pond2: growingStatus[2].active,
                    pond3: growingStatus[3].active,
                    anyActive: anyPondActive
                });
                
                if (!anyPondActive) {
                    console.log('üõë ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏•‡∏¢ -> ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏¥‡∏î‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô + ‡πÑ‡∏ü');
                    
                    // 1. ‡∏õ‡∏¥‡∏î‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô‡∏Å‡πà‡∏≠‡∏ô
                    console.log('üì§ [1/4] ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏õ‡∏¥‡∏î‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô...');
                    const oxygenSuccess = await sendToBlynk('V25', 0);
                    console.log(`   ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå: ${oxygenSuccess ? '‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à' : '‚ùå ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß'}`);
                    
                    if (oxygenSuccess) {
                        oxygenMode = 'MANUAL_OFF';
                        updateOxygenModeUI();
                    }
                    
                    // ‡∏£‡∏≠ 500ms
                    await new Promise(resolve => setTimeout(resolve, 500));
                    
                    // 2. ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü
                    console.log('üì§ [2/4] ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏õ‡∏¥‡∏î‡πÑ‡∏ü...');
                    const lightSuccess = await sendToBlynk('V24', 0);
                    console.log(`   ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå: ${lightSuccess ? '‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à' : '‚ùå ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß'}`);
                    
                    if (lightSuccess) {
                        lightMode = 'MANUAL_OFF';
                        updateLightModeUI();
                    }
                    
                    // ‡∏£‡∏≠ 3 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ (‡πÉ‡∏´‡πâ Arduino ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡πÜ)
                    console.log('‚è≥ ‡∏£‡∏≠ 3 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡πÉ‡∏´‡πâ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏õ‡∏¥‡∏î‡∏à‡∏£‡∏¥‡∏á...');
                    await new Promise(resolve => setTimeout(resolve, 3000));
                    
                    // 3. ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô AUTO
                    console.log('üì§ [3/4] ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô AUTO...');
                    const oxygenAutoSuccess = await sendToBlynk('V25', 2);
                    console.log(`   ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå: ${oxygenAutoSuccess ? '‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à' : '‚ùå ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß'}`);
                    
                    if (oxygenAutoSuccess) {
                        oxygenMode = 'AUTO';
                        updateOxygenModeUI();
                    }
                    
                    // ‡∏£‡∏≠ 500ms
                    await new Promise(resolve => setTimeout(resolve, 500));
                    
                    // 4. ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏ü‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô AUTO
                    console.log('üì§ [4/4] ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏ü‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô AUTO...');
                    const lightAutoSuccess = await sendToBlynk('V24', 2);
                    console.log(`   ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå: ${lightAutoSuccess ? '‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à' : '‚ùå ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß'}`);
                    
                    if (lightAutoSuccess) {
                        lightMode = 'AUTO';
                        updateLightModeUI();
                    }
                    
                    console.log('‚úÖ ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏¥‡∏î‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå');
                    
                } else {
                    console.log('‚úÖ ‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡∏¢‡∏π‡πà -> ‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô + ‡πÑ‡∏ü ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≠');
                }
                
            } else {
                console.error('‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏õ‡∏¥‡∏î‡∏õ‡∏±‡πä‡∏°‡πÑ‡∏î‡πâ');
                alert('‚ö†Ô∏è ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î\n\n‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏õ‡∏¥‡∏î‡∏õ‡∏±‡πä‡∏°‡πÑ‡∏î‡πâ\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á');
                
                // ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤ UI ‡∏Å‡∏•‡∏±‡∏ö
                toggle.classList.add('active');
                if (mode) mode.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Å‡πá‡∏ö...';
            }
        } else {
            console.log('‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß');
        }
    }
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á Alert ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥
function showTemperatureAlert(pondNum, temp, type) {
    const container = document.getElementById('alert-container');
    const alertId = `temp-alert-${pondNum}`;
    
    // ‡∏•‡∏ö alert ‡πÄ‡∏Å‡πà‡∏≤‡∏ñ‡πâ‡∏≤‡∏°‡∏µ
    const oldAlert = document.getElementById(alertId);
    if (oldAlert) {
        oldAlert.remove();
    }
    
    const isCold = type === 'cold';
    const bgColor = isCold 
        ? 'linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%)' 
        : 'linear-gradient(135deg, #FFEBEE 0%, #FFCDD2 100%)';
    const borderColor = isCold ? '#2196F3' : '#F44336';
    const icon = isCold ? '‚ùÑÔ∏è' : 'üî•';
    const title = isCold ? '‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏ï‡πà‡∏≥' : '‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏™‡∏π‡∏á';
    const textColor = isCold ? '#1976D2' : '#C62828';
    
    const alertHtml = `
        <div class="alert-banner" id="${alertId}" style="background: ${bgColor}; border-color: ${borderColor}; animation: slideIn 0.3s;">
            <div class="alert-icon">${icon}</div>
            <div class="alert-content">
                <div class="alert-title" style="color: ${textColor};">${title} - ‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà ${pondNum}</div>
                <div class="alert-text" style="color: ${textColor};">
                    ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: ${temp}¬∞C
                    ${isCold ? '(‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 20¬∞C)' : '(‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤ 28¬∞C)'}
                </div>
            </div>
            <button class="alert-close" onclick="document.getElementById('${alertId}').remove()">√ó</button>
        </div>
    `;
    
    container.insertAdjacentHTML('beforeend', alertHtml);
    
    // ‡∏•‡∏ö alert ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏´‡∏•‡∏±‡∏á 10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
    setTimeout(() => {
        const alert = document.getElementById(alertId);
        if (alert) {
            alert.style.animation = 'slideIn 0.3s reverse';
            setTimeout(() => alert.remove(), 300);
        }
    }, 10000);
}
function checkGrowingTemperatures() {
    if (!notificationSettings.temperature) return;
    
    const now = Date.now();
    const NOTIFY_INTERVAL = 30 * 60 * 1000; // 30 ‡∏ô‡∏≤‡∏ó‡∏µ
    const MIN_NOTIFY_INTERVAL = 60000; // 1 ‡∏ô‡∏≤‡∏ó‡∏µ (‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πâ‡∏≥)
    
    for (let i = 1; i <= 3; i++) {
        if (!growingStatus[i].active) {
            if (temperatureWarnings[i].shown) {
                temperatureWarnings[i].shown = false;
                temperatureWarnings[i].lastTemp = null;
                temperatureWarnings[i].lastNotifyTime = 0;
                saveTemperatureWarnings();
            }
            continue;
        }
        
        const temp = currentTemperatures[i];
        if (temp === null || temp === undefined || isNaN(temp)) continue;
        
        const isOutOfRange = temp < 20 || temp > 28;
        const timeSinceLastNotify = now - temperatureWarnings[i].lastNotifyTime;
        
        // ‚úÖ ‡∏ï‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≤‡∏ô 1 ‡∏ô‡∏≤‡∏ó‡∏µ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ ‡∏´‡∏£‡∏∑‡∏≠ 30 ‡∏ô‡∏≤‡∏ó‡∏µ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πâ‡∏≥
        const shouldNotify = timeSinceLastNotify >= Math.max(NOTIFY_INTERVAL, MIN_NOTIFY_INTERVAL);
        const wasNormal = !temperatureWarnings[i].shown;
        
        if (isOutOfRange && (wasNormal || shouldNotify)) {
            let warningMessage = '';
            let icon = 'üå°Ô∏è';
            let type = 'cold';
            
            if (temp < 20) {
                warningMessage = `‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà ${i}: ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏ï‡πà‡∏≥ ${temp}¬∞C (‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 20¬∞C)\n\n‡∏≠‡∏≤‡∏à‡∏™‡πà‡∏á‡∏ú‡∏•‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï`;
                icon = '‚ùÑÔ∏è';
                type = 'cold';
            } else if (temp > 28) {
                warningMessage = `‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà ${i}: ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏™‡∏π‡∏á ${temp}¬∞C (‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤ 28¬∞C)\n\n‡∏≠‡∏≤‡∏à‡∏™‡πà‡∏á‡∏ú‡∏•‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï`;
                icon = 'üî•';
                type = 'hot';
            }
            
            console.log(`üå°Ô∏è [‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥] ${warningMessage}`);
            
            temperatureWarnings[i].shown = true;
            temperatureWarnings[i].lastTemp = temp;
            temperatureWarnings[i].lastNotifyTime = now;
            saveTemperatureWarnings();
            
            showTemperatureAlert(i, temp, type);
            
            if (notificationSettings.webNotification) {
                sendWebNotification(`${icon} ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥!`, warningMessage, icon);
            }
            
            if (notificationSettings.sound) {
                playNotificationSound();
            }
        }
        
        if (!isOutOfRange && temperatureWarnings[i].shown) {
            temperatureWarnings[i].shown = false;
            temperatureWarnings[i].lastNotifyTime = 0;
            saveTemperatureWarnings();
            
            console.log(`‚úÖ ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà ${i} ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥: ${temp}¬∞C`);
            
            const container = document.getElementById('alert-container');
            const alertId = `temp-normal-${i}`;
            
            const alertHtml = `
                <div class="alert-banner harvest" id="${alertId}" style="animation: slideIn 0.3s;">
                    <div class="alert-icon">‚úÖ</div>
                    <div class="alert-content">
                        <div class="alert-title">‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏õ‡∏Å‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß - ‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà ${i}</div>
                        <div class="alert-text">‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏ó‡∏µ‡πà ${temp}¬∞C</div>
                    </div>
                    <button class="alert-close" onclick="document.getElementById('${alertId}').remove()">√ó</button>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', alertHtml);
            
            setTimeout(() => {
                const alert = document.getElementById(alertId);
                if (alert) {
                    alert.style.animation = 'slideIn 0.3s reverse';
                    setTimeout(() => alert.remove(), 300);
                }
            }, 5000);
        }
    }
}
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏•‡∏π‡∏Å/‡∏´‡∏¢‡∏∏‡∏î‡∏õ‡∏•‡∏π‡∏Å
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏•‡∏π‡∏Å/‡∏´‡∏¢‡∏∏‡∏î‡∏õ‡∏•‡∏π‡∏Å
async function toggleGrowing(pondNum) {
    const status = growingStatus[pondNum];
    
    if (!status.active) {
        // ‚úÖ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏•‡∏π‡∏Å‡πÄ‡∏•‡∏¢ ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏Å‡πà‡∏≠‡∏ô
        const confirmed = await showConfirm(
            'üå± ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏π‡∏Å',
            `‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏•‡∏π‡∏Å‡πÉ‡∏ô‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà ${pondNum} ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`,
            { icon: 'üå±', type: 'normal' }
        );
        
if (confirmed) {
    status.active = true;
    status.startTime = Date.now();
    status.minutes = 0;
    
    // ‚úÖ ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
    delete notifications.harvestNotified[pondNum];
    delete notifications.fertilizerNotified[pondNum];
    notifications.harvest = notifications.harvest.filter(n => n !== pondNum);
    notifications.fertilizer = notifications.fertilizer.filter(f => f.pondNum !== pondNum);
    saveNotificationState();
    
    updateGrowingUI(pondNum, true);
    saveGrowingData();
    
	const growPins = { 1: 'V22', 2: 'V21', 3: 'V20' };
	await sendToBlynk(growPins[pondNum], 1);
    
    console.log(`üå± ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏•‡∏π‡∏Å‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà ${pondNum}`);
}
    } else {
        // ‡∏´‡∏¢‡∏∏‡∏î‡∏õ‡∏•‡∏π‡∏Å
        const confirmed = await showConfirm(
            '‚ö†Ô∏è ‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏π‡∏Å',
            `‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏´‡∏¢‡∏∏‡∏î‡∏õ‡∏•‡∏π‡∏Å‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà ${pondNum} ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?\n\n‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏π‡∏Å‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å`,
            { icon: '‚ö†Ô∏è', type: 'warning', confirmType: 'danger' }
        );
        
if (confirmed) {
            status.active = false;
            status.startTime = null;
            status.minutes = 0;
            
            updateGrowingUI(pondNum, false);
            saveGrowingData();
            
            // ‚≠ê ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥
            temperatureWarnings[pondNum].shown = false;
            temperatureWarnings[pondNum].lastTemp = null;
            temperatureWarnings[pondNum].lastNotifyTime = 0;
            saveTemperatureWarnings();
            
            const growPins = { 1: 'V22', 2: 'V21', 3: 'V20' };
            await sendToBlynk(growPins[pondNum], 0);
            
            console.log(`üõë ‡∏´‡∏¢‡∏∏‡∏î‡∏õ‡∏•‡∏π‡∏Å‡∏Å‡∏£‡∏∞‡∏ö‡∏∞‡∏ó‡∏µ‡πà ${pondNum}`);
            
            // ‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á
            notifications.harvest = notifications.harvest.filter(n => n !== pondNum);
            saveNotificationState();
        }
    }
}
// ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤
async function confirmTimeSettings() {
    const harvestDays = parseInt(document.getElementById('harvest-days').value);
    const harvestTime = document.getElementById('harvest-time').value;
    const fertilizerDays = parseInt(document.getElementById('fertilizer-days').value);
    const fertilizerTime = document.getElementById('fertilizer-time').value;
    
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
    if (isNaN(harvestDays) || harvestDays < 0 || harvestDays > 30) {
        alert('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 0-30 ‡∏ß‡∏±‡∏ô');
        return;
    }
    
    if (isNaN(fertilizerDays) || fertilizerDays < 0 || fertilizerDays > 30) {
        alert('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ô‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 0-30 ‡∏ß‡∏±‡∏ô');
        return;
    }
    
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏ß‡∏•‡∏≤
    const timeRegex = /^([0-1][0-9]|2[0-3]):[0-5][0-9]$/;
    if (!timeRegex.test(harvestTime)) {
        alert('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö HH:MM (‡πÄ‡∏ä‡πà‡∏ô 14:30)');
        return;
    }
    
    if (!timeRegex.test(fertilizerTime)) {
        alert('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö HH:MM (‡πÄ‡∏ä‡πà‡∏ô 14:30)');
        return;
    }
    
    // ‡πÅ‡∏™‡∏î‡∏á Confirm Dialog
    const confirmed = await showConfirm(
        '‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤',
        `‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?\n\n` +
        `üå± ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß: ${harvestDays} ‡∏ß‡∏±‡∏ô ‡πÄ‡∏ß‡∏•‡∏≤ ${harvestTime} ‡∏ô.\n` +
        `üåæ ‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢: ${fertilizerDays} ‡∏ß‡∏±‡∏ô ‡πÄ‡∏ß‡∏•‡∏≤ ${fertilizerTime} ‡∏ô.`,
        { icon: '‚úÖ', type: 'normal' }
    );
    
    if (confirmed) {
        // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
        timeSettings.harvestDays = harvestDays;
        timeSettings.harvestTime = harvestTime;
        timeSettings.fertilizerDays = fertilizerDays;
        timeSettings.fertilizerTime = fertilizerTime;
        
        saveTimeSettings();
        
        // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
        console.log('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:', timeSettings);
        
        // ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (optional)
        if (notificationSettings.sound) {
            playNotificationSound();
        }
        
        // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
        const container = document.getElementById('alert-container');
        const alertId = `alert-success-${Date.now()}`;
        
        const alertHtml = `
            <div class="alert-banner harvest" id="${alertId}" style="animation: slideIn 0.3s;">
                <div class="alert-icon">‚úÖ</div>
                <div class="alert-content">
                    <div class="alert-title">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</div>
                    <div class="alert-text">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</div>
                </div>
                <button class="alert-close" onclick="document.getElementById('${alertId}').remove()">√ó</button>
            </div>
        `;
        
        container.insertAdjacentHTML('beforeend', alertHtml);
        
        // ‡∏•‡∏ö alert ‡∏´‡∏•‡∏±‡∏á 3 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
        setTimeout(() => {
            const alert = document.getElementById(alertId);
            if (alert) {
                alert.style.animation = 'slideIn 0.3s reverse';
                setTimeout(() => alert.remove(), 300);
            }
        }, 3000);
    }
}
// ============================================
// üîî ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏∞‡∏ö‡∏ö Web Notification ‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà
// ============================================

// ‡∏Ç‡∏≠‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤ (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏Ç‡∏≠)
// ‡∏Ç‡∏≠‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤ (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏Ç‡∏≠)
async function initializeNotifications() {
    console.log('üîî ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö Web Notification...');
    
    if (!('Notification' in window)) {
        console.log('‚ùå ‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Web Notification');
        notificationSettings.webNotification = false;
        saveNotificationSettings();
        return;
    }
    
    console.log('üìä ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Permission ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô:', Notification.permission);
    
    // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÅ‡∏•‡πâ‡∏ß
    if (Notification.permission === 'granted') {
        notificationPermission = 'granted';
        console.log('‚úÖ Web Notification ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô');
        
        // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÑ‡∏ß‡πâ ‡∏™‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö
        if (notificationSettings.webNotification) {
            sendWebNotification(
                '‚úÖ Web Notification ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô',
                '‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥',
                'üîî'
            );
        }
        return;
    }
    
    // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏Ç‡∏≠ ‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î Web Notification ‡πÑ‡∏ß‡πâ
    if (Notification.permission === 'default') {
        console.log('‚ö†Ô∏è ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Ç‡∏≠‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Web Notification');
        
        if (notificationSettings.webNotification) {
            console.log('üîî ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ç‡∏≠‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Web Notification...');
            const granted = await requestNotificationPermission();
            
            if (granted) {
                console.log('‚úÖ ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Web Notification ‡πÅ‡∏•‡πâ‡∏ß');
                sendWebNotification(
                    '‚úÖ ‡πÄ‡∏õ‡∏¥‡∏î Web Notification ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                    '‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏°‡πâ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß',
                    'üîî'
                );
            } else {
                console.log('‚ùå ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Web Notification');
                notificationSettings.webNotification = false;
                const toggle = document.getElementById('web-notif-toggle');
                if (toggle) toggle.classList.remove('active');
                saveNotificationSettings();
            }
        }
        return;
    }
    
    // ‡∏ñ‡πâ‡∏≤‡∏ñ‡∏π‡∏Å‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò
    if (Notification.permission === 'denied') {
        console.log('üö´ Web Notification ‡∏ñ‡∏π‡∏Å‡∏ö‡∏•‡πá‡∏≠‡∏Å');
        notificationSettings.webNotification = false;
        const toggle = document.getElementById('web-notif-toggle');
        if (toggle) toggle.classList.remove('active');
        saveNotificationSettings();
    }
}

// ‡∏´‡∏≤‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ (‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡πâ‡∏î)
document.addEventListener('DOMContentLoaded', async function() {
    console.log('üì± ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏∞‡∏ö‡∏ö...');
    
    resetTimeSettingsOnce();
    
    // 1Ô∏è‚É£ ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
    loadDarkMode(); 
    loadGrowingData();
    loadHistory();
    loadFertilizerHistory();
    updateTime();
    loadNotificationSettings();
    
    // ‚≠ê ‡∏£‡∏≠‡πÉ‡∏´‡πâ DOM ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡πà‡∏≠‡∏ô‡πÇ‡∏´‡∏•‡∏î Time Settings
    setTimeout(() => {
        loadTimeSettings();
        console.log('‚úÖ ‡πÇ‡∏´‡∏•‡∏î Time Settings ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô');
    }, 100);
    
    loadNotificationState();
    loadTemperatureWarnings();
    
    // 2Ô∏è‚É£ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö Web Notification
    await initializeNotifications();
    
    // ‚≠ê 3Ô∏è‚É£ ‡πÄ‡∏û‡∏¥‡πà‡∏° Event Listeners ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏ö‡∏ö real-time
    const harvestDays = document.getElementById('harvest-days');
    const harvestTime = document.getElementById('harvest-time');
    const fertilizerDays = document.getElementById('fertilizer-days');
    const fertilizerTime = document.getElementById('fertilizer-time');
    
    if (harvestDays) {
        harvestDays.addEventListener('change', () => {
            console.log('üìÖ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß:', harvestDays.value);
            updateExampleText();
        });
    }
    
    if (harvestTime) {
        harvestTime.addEventListener('change', () => {
            console.log('üïê ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß:', harvestTime.value);
            updateExampleText();
        });
    }
    
    if (fertilizerDays) {
        fertilizerDays.addEventListener('change', () => {
            console.log('üìÖ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ß‡∏±‡∏ô‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢:', fertilizerDays.value);
            updateExampleText();
        });
    }
    
    if (fertilizerTime) {
        fertilizerTime.addEventListener('change', () => {
            console.log('üïê ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢:', fertilizerTime.value);
            updateExampleText();
        });
    }
    
    // 4Ô∏è‚É£ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Blynk
    console.log('üöÄ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Blynk...');
    fetchBlynkData();
    
    // 5Ô∏è‚É£ ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ intervals
    setInterval(updateTime, 1000);
    setInterval(updateGrowingTimers, 1000);
	setInterval(checkNotifications, 10000);  // ‚Üê ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô 10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
	setInterval(checkGrowingTemperatures, 30000);  // ‚Üê ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
    
    setInterval(() => {
        if (!demoMode) {
            fetchBlynkData();
        }
    }, 2000);
    
    // 6Ô∏è‚É£ ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
    checkNotifications();
    checkGrowingTemperatures();
    
    console.log('‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô');
});
    </script>
</body>



/*************** BLYNK ****************/
#define BLYNK_TEMPLATE_ID "TMPL6LjhOd_ip"
#define BLYNK_TEMPLATE_NAME "khaipham"
#define BLYNK_PRINT Serial

#include <WiFi.h>
#include <WiFiClientSecure.h>
#include <BlynkSimpleEsp32_SSL.h>
#include <OneWire.h>
#include <DallasTemperature.h>

/*************** WIFI *****************/
char auth[] = "nTrLz6j8b6HiFBJqOjpWOojef9uDSArt";  // ‚úÖ Token ‡πÉ‡∏´‡∏°‡πà
char ssid[] = "bank29/417_5G";
char pass[] = "nat251155";

/*************** PIN *****************/
#define PUMP1 27
#define PUMP2 14
#define PUMP3 12
#define PUMP4 18

#define SENSOR1 34
#define SENSOR2 32
#define SENSOR3 33
#define SENSOR4 25

#define RELAY_OXYGEN  15
#define RELAY_LIGHT   16

#define LDR_PIN 35
#define LDR_THRESHOLD 2000

#define TEMP_PIN_1 23
#define TEMP_PIN_2 22
#define TEMP_PIN_3 19

/*************** BLYNK PIN ************/
#define VLIGHT        V24
#define VOXYGEN       V25
#define VLIGHT_LED    V0
#define VOXYGEN_LED   V1
#define VWATER1_LED   V15
#define VWATER2_LED   V16
#define VWATER3_LED   V17
#define VWATER4_LED   V2
#define VPUMP1        V10
#define VPUMP2        V11
#define VPUMP3        V12
#define VGROW1        V22
#define VGROW2        V21
#define VGROW3        V20

/*************** STATE ***************/
enum LightMode {
  LIGHT_AUTO,
  LIGHT_MANUAL_ON,
  LIGHT_MANUAL_OFF
};
LightMode lightMode = LIGHT_AUTO;

enum OxygenMode {
  OXYGEN_AUTO,
  OXYGEN_MANUAL_ON,
  OXYGEN_MANUAL_OFF
};
OxygenMode oxygenMode = OXYGEN_AUTO;

bool pump1Manual = false;
bool pump2Manual = false;
bool pump3Manual = false;

bool isGrowing1 = false;
bool isGrowing2 = false;
bool isGrowing3 = false;

/*************** DS18B20 *************/
OneWire oneWire1(TEMP_PIN_1);
OneWire oneWire2(TEMP_PIN_2);
OneWire oneWire3(TEMP_PIN_3);

DallasTemperature temp1(&oneWire1);
DallasTemperature temp2(&oneWire2);
DallasTemperature temp3(&oneWire3);

BlynkTimer timer;

/*************** BLYNK WRITE *********/

// ‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏ü: ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ 0 = MANUAL_OFF, 1 = MANUAL_ON, 2 = AUTO
BLYNK_WRITE(VLIGHT) {
  int value = param.asInt();
  
  Serial.print("üîî [BLYNK] ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á V24 = ");
  Serial.println(value);
  
  if (value == 0) {
    lightMode = LIGHT_MANUAL_OFF;
    Serial.println("üí° Light: MANUAL OFF ‚Üí ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏ó‡∏±‡∏ô‡∏ó‡∏µ");
  } else if (value == 1) {
    lightMode = LIGHT_MANUAL_ON;
    Serial.println("üí° Light: MANUAL ON ‚Üí ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏ó‡∏±‡∏ô‡∏ó‡∏µ");
  } else if (value == 2) {
    lightMode = LIGHT_AUTO;
    Serial.println("üí° Light: AUTO MODE ‚Üí ‡πÉ‡∏ä‡πâ‡πÇ‡∏´‡∏°‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥");
  }
}

// ‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô: ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ 0 = MANUAL_OFF, 1 = MANUAL_ON, 2 = AUTO
BLYNK_WRITE(VOXYGEN) {
  int value = param.asInt();
  
  Serial.print("üîî [BLYNK] ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á V25 = ");
  Serial.println(value);
  
  if (value == 0) {
    oxygenMode = OXYGEN_MANUAL_OFF;
    Serial.println("üí® Oxygen: MANUAL OFF ‚Üí ‡∏õ‡∏¥‡∏î‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ");
  } else if (value == 1) {
    oxygenMode = OXYGEN_MANUAL_ON;
    Serial.println("üí® Oxygen: MANUAL ON ‚Üí ‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ");
  } else if (value == 2) {
    oxygenMode = OXYGEN_AUTO;
    Serial.println("üí® Oxygen: AUTO MODE ‚Üí ‡πÉ‡∏ä‡πâ‡πÇ‡∏´‡∏°‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥");
  }
}

// ‚úÖ ‡∏õ‡∏±‡πä‡∏° 1 (‡∏Å‡∏£‡∏∞‡∏ö‡∏∞ 1)
BLYNK_WRITE(VPUMP1) {
  bool water1 = (digitalRead(SENSOR3) == HIGH);
  
  if (param.asInt() == 0) {
    pump1Manual = false;
    Serial.println("üíß Pump 1 (‡∏Å‡∏£‡∏∞‡∏ö‡∏∞1): Manual OFF");
  } else if (water1) {
    pump1Manual = true;
    Serial.println("üíß Pump 1 (‡∏Å‡∏£‡∏∞‡∏ö‡∏∞1): Manual ON");
  } else {
    pump1Manual = false;
    Blynk.virtualWrite(VPUMP1, 0);
    Serial.println("‚ö†Ô∏è Pump 1 (‡∏Å‡∏£‡∏∞‡∏ö‡∏∞1): ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ô‡πâ‡∏≥");
  }
}

// ‚úÖ ‡∏õ‡∏±‡πä‡∏° 2 (‡∏Å‡∏£‡∏∞‡∏ö‡∏∞ 2)
BLYNK_WRITE(VPUMP2) {
  bool water2 = (digitalRead(SENSOR2) == HIGH);
  
  if (param.asInt() == 0) {
    pump2Manual = false;
    Serial.println("üíß Pump 2 (‡∏Å‡∏£‡∏∞‡∏ö‡∏∞2): Manual OFF");
  } else if (water2) {
    pump2Manual = true;
    Serial.println("üíß Pump 2 (‡∏Å‡∏£‡∏∞‡∏ö‡∏∞2): Manual ON");
  } else {
    pump2Manual = false;
    Blynk.virtualWrite(VPUMP2, 0);
    Serial.println("‚ö†Ô∏è Pump 2 (‡∏Å‡∏£‡∏∞‡∏ö‡∏∞2): ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ô‡πâ‡∏≥");
  }
}

// ‚úÖ ‡∏õ‡∏±‡πä‡∏° 3 (‡∏Å‡∏£‡∏∞‡∏ö‡∏∞ 3)
BLYNK_WRITE(VPUMP3) {
  bool water3 = (digitalRead(SENSOR1) == HIGH);
  
  if (param.asInt() == 0) {
    pump3Manual = false;
    Serial.println("üíß Pump 3 (‡∏Å‡∏£‡∏∞‡∏ö‡∏∞3): Manual OFF");
  } else if (water3) {
    pump3Manual = true;
    Serial.println("üíß Pump 3 (‡∏Å‡∏£‡∏∞‡∏ö‡∏∞3): Manual ON");
  } else {
    pump3Manual = false;
    Blynk.virtualWrite(VPUMP3, 0);
    Serial.println("‚ö†Ô∏è Pump 3 (‡∏Å‡∏£‡∏∞‡∏ö‡∏∞3): ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ô‡πâ‡∏≥");
  }
}

// ‚úÖ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏π‡∏Å
BLYNK_WRITE(VGROW1) {
  isGrowing1 = param.asInt();
  Serial.print("üå± Pond 1 Growing: ");
  Serial.println(isGrowing1 ? "START" : "STOP");
}

BLYNK_WRITE(VGROW2) {
  isGrowing2 = param.asInt();
  Serial.print("üå± Pond 2 Growing: ");
  Serial.println(isGrowing2 ? "START" : "STOP");
}

BLYNK_WRITE(VGROW3) {
  isGrowing3 = param.asInt();
  Serial.print("üå± Pond 3 Growing: ");
  Serial.println(isGrowing3 ? "START" : "STOP");
}

/*************** SEND TEMP ***********/
void sendTemperature() {
  temp1.requestTemperatures();
  temp2.requestTemperatures();
  temp3.requestTemperatures();

  float t1 = temp1.getTempCByIndex(0);
  float t2 = temp2.getTempCByIndex(0);
  float t3 = temp3.getTempCByIndex(0);

  if (t1 == DEVICE_DISCONNECTED_C || t1 < -50 || t1 > 100) {
    Serial.println("‚ö†Ô∏è Temp Sensor 1 Error!");
    t1 = -127;
  }
  if (t2 == DEVICE_DISCONNECTED_C || t2 < -50 || t2 > 100) {
    Serial.println("‚ö†Ô∏è Temp Sensor 2 Error!");
    t2 = -127;
  }
  if (t3 == DEVICE_DISCONNECTED_C || t3 < -50 || t3 > 100) {
    Serial.println("‚ö†Ô∏è Temp Sensor 3 Error!");
    t3 = -127;
  }

  Blynk.virtualWrite(V7, t2);
  Blynk.virtualWrite(V6, t1);
  Blynk.virtualWrite(V5, t3);
}

/*************** SETUP ***************/
void setup() {
  Serial.begin(115200);
  delay(1000);
  
  Serial.println("\n\n========================================");
  Serial.println("üå± Baby Phum Machine v8.0 - SSL FIXED");
  Serial.println("========================================");

  pinMode(PUMP1, OUTPUT);
  pinMode(PUMP2, OUTPUT);
  pinMode(PUMP3, OUTPUT);
  pinMode(PUMP4, OUTPUT);

  pinMode(SENSOR1, INPUT);
  pinMode(SENSOR2, INPUT);
  pinMode(SENSOR3, INPUT);
  pinMode(SENSOR4, INPUT);

  pinMode(RELAY_LIGHT, OUTPUT);
  pinMode(RELAY_OXYGEN, OUTPUT);
  pinMode(LDR_PIN, INPUT);

  digitalWrite(PUMP1, HIGH);
  digitalWrite(PUMP2, HIGH);
  digitalWrite(PUMP3, HIGH);
  digitalWrite(PUMP4, HIGH);
  digitalWrite(RELAY_LIGHT, HIGH);
  digitalWrite(RELAY_OXYGEN, HIGH);

  temp1.begin();
  temp2.begin();
  temp3.begin();

  // =============================
  // üîç WiFi Connection
  // =============================
  Serial.println("\n[WiFi] ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...");
  Serial.print("[WiFi] SSID: ");
  Serial.println(ssid);
  
  WiFi.mode(WIFI_STA);
  WiFi.begin(ssid, pass);
  
  int wifiAttempts = 0;
  while (WiFi.status() != WL_CONNECTED && wifiAttempts < 40) {
    delay(500);
    Serial.print(".");
    wifiAttempts++;
  }
  
  Serial.println();
  
  if (WiFi.status() != WL_CONNECTED) {
    Serial.println("‚ùå [WiFi] ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß - ‡∏£‡∏µ‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó ESP32");
    delay(3000);
    ESP.restart();
  }
  
  Serial.println("‚úÖ [WiFi] ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");
  Serial.print("‚úÖ [WiFi] IP Address: ");
  Serial.println(WiFi.localIP());
  Serial.print("‚úÖ [WiFi] Signal: ");
  Serial.print(WiFi.RSSI());
  Serial.println(" dBm");
  
  // =============================
  // üîç Blynk Connection (SSL)
  // =============================
  Serial.println("\n[Blynk] ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ (SSL)...");
  Serial.print("[Blynk] Server: blynk.cloud:443");
  Serial.println();
  Serial.print("[Blynk] Auth Token: ");
  Serial.println(auth);
  
  // ‚úÖ ‡πÉ‡∏ä‡πâ Blynk SSL (port 443)
  Blynk.begin(auth, ssid, pass);
  
  // ‡∏£‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
  int blynkAttempts = 0;
  while (!Blynk.connected() && blynkAttempts < 30) {
    Serial.print(".");
    delay(500);
    blynkAttempts++;
  }
  
  Serial.println();
  
  if (Blynk.connected()) {
    Serial.println("‚úÖ [Blynk] ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");
    
    // ‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
    Serial.println("[Blynk] ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô...");
    Blynk.virtualWrite(VLIGHT_LED, 0);
    Blynk.virtualWrite(VOXYGEN_LED, 0);
    Blynk.virtualWrite(VWATER1_LED, 0);
    Blynk.virtualWrite(VWATER2_LED, 0);
    Blynk.virtualWrite(VWATER3_LED, 0);
    Blynk.virtualWrite(VWATER4_LED, 0);
    Blynk.virtualWrite(VPUMP1, 0);
    Blynk.virtualWrite(VPUMP2, 0);
    Blynk.virtualWrite(VPUMP3, 0);
    Blynk.virtualWrite(VGROW1, 0);
    Blynk.virtualWrite(VGROW2, 0);
    Blynk.virtualWrite(VGROW3, 0);
    Serial.println("‚úÖ [Blynk] ‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
    
  } else {
    Serial.println("‚ùå [Blynk] ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß!");
    Serial.println("‚ùå [Blynk] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:");
    Serial.println("   1. Auth Token ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà");
    Serial.println("   2. Template ID ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÉ‡∏ô Blynk Console ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà");
    Serial.println("   3. Device ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏ô Blynk Console ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà");
    Serial.println("   4. ‡∏™‡∏£‡πâ‡∏≤‡∏á Device ‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà: https://blynk.cloud");
    Serial.println("\n‚ö†Ô∏è ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≠ ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏ú‡πà‡∏≤‡∏ô Blynk ‡πÑ‡∏î‡πâ");
  }
  
  Serial.println("\n========================================");
  Serial.println("‚úÖ Light: AUTO / MANUAL_ON / MANUAL_OFF");
  Serial.println("‚úÖ Oxygen: AUTO / MANUAL_ON / MANUAL_OFF");
  Serial.println("‚úÖ Pump 4 ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô AUTO ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô");
  Serial.println("========================================");
  Serial.println("System Ready üöÄ");
  Serial.println("========================================\n");
  
  timer.setInterval(2000L, sendTemperature);
}

/*************** LOOP ***************/
void loop() {
  // ‚úÖ Auto Reconnect WiFi
  static unsigned long lastWiFiCheck = 0;
  if (millis() - lastWiFiCheck > 30000) {
    if (WiFi.status() != WL_CONNECTED) {
      Serial.println("\n‚ö†Ô∏è WiFi ‡∏´‡∏•‡∏∏‡∏î! ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà...");
      WiFi.reconnect();
      
      int attempts = 0;
      while (WiFi.status() != WL_CONNECTED && attempts < 20) {
        delay(500);
        Serial.print(".");
        attempts++;
      }
      
      if (WiFi.status() == WL_CONNECTED) {
        Serial.println("\n‚úÖ WiFi ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");
        Serial.print("‚úÖ IP: ");
        Serial.println(WiFi.localIP());
      } else {
        Serial.println("\n‚ùå WiFi ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß - ‡∏£‡∏µ‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó ESP32");
        delay(3000);
        ESP.restart();
      }
    }
    lastWiFiCheck = millis();
  }
  
  // ‚úÖ Auto Reconnect Blynk
  static unsigned long lastBlynkCheck = 0;
  if (millis() - lastBlynkCheck > 15000) {
    if (!Blynk.connected()) {
      Serial.println("\n‚ö†Ô∏è Blynk ‡∏´‡∏•‡∏∏‡∏î! ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà...");
      Blynk.connect();
      
      int attempts = 0;
      while (!Blynk.connected() && attempts < 15) {
        delay(500);
        Serial.print(".");
        attempts++;
      }
      
      if (Blynk.connected()) {
        Serial.println("\n‚úÖ Blynk ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");
      } else {
        Serial.println("\n‚ùå Blynk ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß (‡∏à‡∏∞‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô‡∏≠‡∏µ‡∏Å 15 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)");
      }
    }
    lastBlynkCheck = millis();
  }
  
  Blynk.run();
  timer.run();

  // ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡πà‡∏≤ LDR ‡∏ó‡∏∏‡∏Å 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
  static unsigned long lastLDRPrint = 0;
  if (millis() - lastLDRPrint > 5000) {
    int ldrValue = analogRead(LDR_PIN);
    Serial.print("üìä LDR: ");
    Serial.print(ldrValue);
    Serial.print(" (Threshold: ");
    Serial.print(LDR_THRESHOLD);
    Serial.println(ldrValue >= LDR_THRESHOLD ? ") ‚Üí DARK ‚ö´" : ") ‚Üí BRIGHT ‚òÄÔ∏è");
    lastLDRPrint = millis();
  }

  // ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤ sensor ‡∏ô‡πâ‡∏≥
  bool water1 = (digitalRead(SENSOR3) == HIGH);
  bool water2 = (digitalRead(SENSOR2) == HIGH);
  bool water3 = (digitalRead(SENSOR1) == HIGH);
  bool water4 = (digitalRead(SENSOR4) == LOW);

  Blynk.virtualWrite(VWATER1_LED, water1 ? 1 : 0);
  Blynk.virtualWrite(VWATER2_LED, water2 ? 1 : 0);
  Blynk.virtualWrite(VWATER3_LED, water3 ? 1 : 0);
  Blynk.virtualWrite(VWATER4_LED, water4 ? 1 : 0);

  bool anyGrowing = (isGrowing1 || isGrowing2 || isGrowing3);

  // ‚úÖ ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° Pump 1-3
  bool pump1On = false;
  bool pump2On = false;
  bool pump3On = false;
  
  if (isGrowing1) {
    if (pump1Manual) {
      pump1On = water1;
    } else {
      pump1On = !water1;
    }
  }
  
  if (isGrowing2) {
    if (pump2Manual) {
      pump2On = water2;
    } else {
      pump2On = !water2;
    }
  }
  
  if (isGrowing3) {
    if (pump3Manual) {
      pump3On = water3;
    } else {
      pump3On = !water3;
    }
  }

  digitalWrite(PUMP2, pump1On ? LOW : HIGH);
  digitalWrite(PUMP3, pump2On ? LOW : HIGH);
  digitalWrite(PUMP1, pump3On ? LOW : HIGH);
  
  // ‚úÖ Pump4: AUTO ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
  bool pump4On = !water4;
  digitalWrite(PUMP4, pump4On ? LOW : HIGH);

  // ‚úÖ ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÑ‡∏ü‡∏ï‡∏≤‡∏° LDR ‡πÅ‡∏•‡∏∞‡πÇ‡∏´‡∏°‡∏î
  int ldrValue = analogRead(LDR_PIN);
  bool isDark = (ldrValue >= LDR_THRESHOLD);

  bool lightOn = false;
  
  switch (lightMode) {
    case LIGHT_MANUAL_OFF:
      lightOn = false;
      break;
      
    case LIGHT_MANUAL_ON:
      lightOn = true;
      break;
      
    case LIGHT_AUTO:
      lightOn = (isDark && anyGrowing);
      break;
  }
  
  digitalWrite(RELAY_LIGHT, lightOn ? LOW : HIGH);
  Blynk.virtualWrite(VLIGHT_LED, lightOn ? 1 : 0);

  // ‚úÖ ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô‡∏ï‡∏≤‡∏°‡πÇ‡∏´‡∏°‡∏î
  bool oxygenOn = false;

  switch (oxygenMode) {
    case OXYGEN_MANUAL_OFF:
      oxygenOn = false;
      break;
      
    case OXYGEN_MANUAL_ON:
      oxygenOn = true;
      break;
      
    case OXYGEN_AUTO:
      oxygenOn = anyGrowing;
      break;
  }

  digitalWrite(RELAY_OXYGEN, oxygenOn ? HIGH : LOW);
  Blynk.virtualWrite(VOXYGEN_LED, oxygenOn ? 1 : 0);

  // ‡πÅ‡∏™‡∏î‡∏á Status ‡∏ó‡∏∏‡∏Å 10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
  static unsigned long lastPrint = 0;
  if (millis() - lastPrint > 10000) {
    Serial.println("\n========== STATUS ==========");
    
    // WiFi & Blynk Status
    Serial.print("üì° WiFi: ");
    Serial.print(WiFi.status() == WL_CONNECTED ? "‚úì Connected" : "‚úó Disconnected");
    if (WiFi.status() == WL_CONNECTED) {
      Serial.print(" (");
      Serial.print(WiFi.RSSI());
      Serial.print(" dBm)");
    }
    Serial.println();
    
    Serial.print("‚òÅÔ∏è Blynk: ");
    Serial.println(Blynk.connected() ? "‚úì Connected" : "‚úó Disconnected");
    
    Serial.print("üå± Growing: [");
    Serial.print(isGrowing1 ? "1" : "-");
    Serial.print(isGrowing2 ? "2" : "-");
    Serial.print(isGrowing3 ? "3" : "-");
    Serial.println("]");
    
    Serial.print("üí® Oxygen: ");
    Serial.print(oxygenOn ? "ON ‚úì" : "OFF");
    Serial.print(" (");
    if (oxygenMode == OXYGEN_AUTO) Serial.print("AUTO");
    else if (oxygenMode == OXYGEN_MANUAL_ON) Serial.print("MANUAL ON");
    else if (oxygenMode == OXYGEN_MANUAL_OFF) Serial.print("MANUAL OFF");
    Serial.println(")");
    
    Serial.print("üí° Light: ");
    Serial.print(lightOn ? "ON ‚úì" : "OFF");
    Serial.print(" (");
    if (lightMode == LIGHT_AUTO) Serial.print("AUTO");
    else if (lightMode == LIGHT_MANUAL_ON) Serial.print("MANUAL ON");
    else if (lightMode == LIGHT_MANUAL_OFF) Serial.print("MANUAL OFF");
    Serial.print(") LDR=");
    Serial.print(ldrValue);
    Serial.print(isDark ? " [DARK]" : " [BRIGHT]");
    Serial.println();
    
    Serial.print("üíß Pumps: [");
    Serial.print(pump1On ? "1" : "-");
    Serial.print(pump2On ? "2" : "-");
    Serial.print(pump3On ? "3" : "-");
    Serial.print("] Pump4:");
    Serial.print(pump4On ? "ON" : "OFF");
    Serial.print(" (AUTO)");
    Serial.println();
    
    Serial.print("üíß Water: [");
    Serial.print(water1 ? "1" : "-");
    Serial.print(water2 ? "2" : "-");
    Serial.print(water3 ? "3" : "-");
    Serial.print("] Tank:");
    Serial.print(water4 ? "FULL ‚úì" : "LOW ‚ö†Ô∏è");
    Serial.println();
    Serial.println("===========================\n");
    lastPrint = millis();
  }

  delay(200);
}

